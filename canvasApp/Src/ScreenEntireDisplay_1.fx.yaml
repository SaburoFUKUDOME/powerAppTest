ScreenEntireDisplay_1 As screen:
    OnVisible: |+
        =UpdateContext({
        _lNewLine:Char(10),
        _lIcon:"■",
        _lCustomer:"属性・背景",_lJTBD:"JTBD",_lHindranceFactor:"阻害要因",_lCurrentMeasures:"現状対策",_lSatisfaction:"満足状況",_lVP:"VP",_lMVP:"MVP"// キャンバスのタイトル
        });
        
        // コレクションを作成
        ClearCollect(colCustomer,Sort(Filter(_cAnswerList,And(themeID=themeId,category="顧客")),questionID));
        ClearCollect(colJTBD,Sort(Filter(_cAnswerList,And(themeID=themeId,category="目的（JTBD）")),questionID));
        ClearCollect(colHindranceFactor,Sort(Filter(_cAnswerList,And(themeID=themeId,category="阻害要因（課題）")),questionID));
        ClearCollect(colCurrentMeasures,Sort(Filter(_cAnswerList,And(themeID=themeId,category="現状対策（代替）")),questionID));
        ClearCollect(colSatisfaction,Sort(Filter(_cAnswerList,And(themeID=themeId,category="満足状況")),questionID));
        ClearCollect(colVP,Sort(Filter(_cAnswerList,And(themeID=themeId,category="提供価値")),questionID));
        ClearCollect(colMVP,Sort(Filter(_cAnswerList,And(themeID=themeId,category="MVP（ソリューション）")),questionID));
        
        // キャンバスのボックス内に表示する文字を作成(追加できるカテゴリは、ギャラリー内の各ラベルで作成する)
        UpdateContext({
        _lCustomerData:Concat(colCustomer,_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine),// 属性・背景
        _lJTBDData:Concat(colJTBD,_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine),// JTBD
        _lMVPData:Concat(colMVP,_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)// MVP
        });
        

    cmHeader_6 As cmHeader:

    HeaderContainer_3 As groupContainer.manualLayoutContainer:
        Height: =66
        Width: =MainContainer3.Width
        Y: =cmHeader_4.Height
        ZIndex: =2

        cmStatusBar_3 As cmStatusBar:
            checkStatus: |-
                =With({
                categoryQuestionCount:
                // 前提条件、顧客、目的、MVPの場合は、問の複数追加は無いのでそのままの件数をセットする
                If(Or(navigationKey=1,navigationKey=2,navigationKey=3,navigationKey=8),
                CountIf(questionList,category=navigationName),
                // それ以外の場合は、問の追加分かけた件数をセットする
                CountIf(questionList,category=navigationName)*_gMaxSortNumber),
                answerTable:Filter('仮説構築支援ツール - 回答',And(category=navigationName,themeID=themeId))},
                If(CountIf(answerTable,status=completeStatus)=categoryQuestionCount,10,
                CountIf(answerTable,(status=incompleteStatus)||(status=completeStatus))>noneStatus,
                2,1))
            X: =900

        lineContainer2_4 As groupContainer.verticalAutoLayoutContainer:
            Height: =66
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMode: =LayoutMode.Auto
            Width: =HeaderContainer_3.Width
            ZIndex: =1

            Label2_7 As label:
                FontWeight: =FontWeight.Bold
                Height: =44
                Overflow: =Overflow.Scroll
                Size: =16
                Text: =_gThemeName
                Width: =780
                X: =50
                Y: =461
                ZIndex: =1

            Rectangle3_6 As rectangle:
                BorderColor: =_cBaseColor
                Fill: =_cBaseColor
                Height: =4
                Width: =Max(App.Width-60, App.MinScreenWidth-60)
                X: =50
                Y: =505
                ZIndex: =2

        ContainerLink_3 As groupContainer.manualLayoutContainer:
            Height: =Parent.Height
            Width: =107
            X: =Rectangle3_3.Width-70
            ZIndex: =3

            Label1_4 As label:
                Height: =18
                Size: =8
                Text: ="共創活性化ポータル"
                Width: =107
                Y: =Icon4_2.Height
                ZIndex: =1

            Icon4_2 As icon.OpenInNewWindow:
                Color: =_cBaseColor
                Height: =25
                Icon: =Icon.OpenInNewWindow
                OnSelect: |-
                    =Launch("https://rfgricoh.sharepoint.com/sites/ZJS_cocreation_portal/SitePages/reference.aspx?OR=Teams-HL&CT=1665043619579&clickparams=eyJBcHBOYW1lIjoiVGVhbXMtRGVza3RvcCIsIkFwcFZlcnNpb24iOiIyNy8yMjA5MDQwMDcxMiIsIkhhc0ZlZGVyYXRlZFVzZXIiOmZhbHNlfQ%3D%3D#psf%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E4%BA%8B%E4%BE%8B%E9%9B%86")
                Tooltip: ="別タブで共創活性化ポータルを開く"
                Width: =30
                X: =39
                Y: =2
                ZIndex: =3

    ContainerHeader_2 As groupContainer.manualLayoutContainer:
        Height: =60
        Width: =Max(App.Width, App.MinScreenWidth)
        Y: =180
        ZIndex: =3

        Image_2 As image:
            Height: =Parent.Height
            Image: =header
            Width: =Parent.Width
            ZIndex: =1

    ContainerMain_2 As groupContainer.manualLayoutContainer:
        Height: =640
        Width: =Max(App.Width, App.MinScreenWidth)
        Y: =128
        ZIndex: =4

        Button1_1 As button:
            Fill: =_cBaseColor
            Height: =44
            Text: ="前提条件を設定"
            Width: =222
            X: =1110
            Y: =2
            ZIndex: =1

        ContainerFooter3_2 As groupContainer.manualLayoutContainer:
            Height: =50
            Width: =Parent.Width
            Y: =590
            ZIndex: =2

            IconBackThemeScreen_4 As icon.BackArrow:
                Color: =_cBaseColor
                Height: =30
                Icon: =Icon.BackArrow
                OnSelect: =Navigate(screenCanvas,Fade)
                Tooltip: ="Home画面へ戻る"
                Width: =30
                X: =11
                Y: =10
                ZIndex: =2

            Label3_3 As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =16
                LineHeight: =1.0
                Size: =11
                Text: ="©New*New All rights reserved."
                Width: =268
                X: =515
                Y: =10
                ZIndex: =4

            ButtonDLCsv_2 As button:
                BorderColor: =_cBaseColor
                BorderThickness: =0
                Fill: =_cBaseColor
                FocusedBorderColor: =ColorFade(_cBaseColor,-20%)
                FocusedBorderThickness: =0
                FontWeight: =Semibold
                Height: =30
                HoverBorderColor: =ColorFade(_cBaseColor,-20%)
                HoverFill: =ColorFade(_cBaseColor,-20%)
                OnSelect: =Set(_gIsShowDialog,true);
                PressedBorderColor: =ColorFade(_cBaseColor,-20%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(_cBaseColor,-20%)
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =14
                Text: ="CSV出力"
                Tooltip: ="回答のCSVファイルをダウンロード"
                Width: =150
                X: =1199
                Y: =10
                ZIndex: =5

        ContainerCanvas_2 As groupContainer.manualLayoutContainer:
            Height: =496
            Width: =Parent.Width
            Y: =106
            ZIndex: =3

            ContainerMVP_2 As groupContainer.manualLayoutContainer:
                Height: =448
                Width: =Parent.Width/7.5
                X: =5
                Y: =48
                ZIndex: =1

                LabelBoxMVP_2 As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =1

                LabelTitleMVP_2 As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: =_lMVP
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =2

                LabelDetailMVP_2 As label:
                    Height: =Parent.Height-LabelTitleCustomer_2.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lMVPData
                        /**
                        With({_startid:19},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+1).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+1).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+2).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+2).answer
                        )
                        */
                    Width: =172.13333333333333
                    X: =10
                    Y: =50
                    ZIndex: =3

                Icon2_7 As icon.Edit:
                    Height: =38
                    Icon: =Icon.Edit
                    OnSelect: |-
                        =Set(
                            addAnswer,
                            false
                        );
                        Set(
                            addAnswerId,
                            0
                        );
                        
                        
                        //問いへ遷移
                        Set(
                            navigationKey,
                            19
                        );
                        Set(
                            questionKey,
                            19
                        );
                        With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                        Reset(textAnswer);
                        Reset(skipAnswerCheckbox);
                        Reset(noAnswerCheckbox);
                        Set(
                            currentAnswer,
                            If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                            );
                        Set(
                            skipFlag,
                            getAnswerRecord.skip_flag
                            );
                        Set(
                            noAnswerFlag,
                            getAnswerRecord.no_answer_flag
                            );
                        );
                        
                        With({qRecord:LookUp(questionList, ID=questionKey)},
                        Set(
                            currentTitle,
                            qRecord.Title
                        );
                        Set(
                            currentQuestion,
                            qRecord.question_content
                        );
                        Set(currentCategory,qRecord.category);
                        Set(
                            controlType,
                            qRecord.control_type
                        );
                        Set(
                            currentPage,
                            qRecord.current_question_number
                        );
                        Set(
                            totalPage,
                            qRecord.question_totalnumber
                        );
                        Set(
                            commentary,
                            qRecord.commentary
                        );
                        Set(
                            example,
                            qRecord.example
                        );
                        Set(
                            currentRequired,
                            qRecord.required
                        );
                        Set(
                            nextVisible,
                            If(qRecord.next_question_id=0,false,true)
                        
                        );
                        Set(
                            confirmVisible,
                            If(qRecord.next_question_id=0,true,false)
                        );
                        );
                        Set(
                            backVisible,
                            false
                        );
                        Set(
                            commentaryGroupVisible,
                            true
                        );
                        Set(
                            exampleGroupVisible,
                            false
                        );
                        If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                        Navigate(
                            scrennQuestion,
                            ScreenTransition.Fade
                        );
                    Width: =38
                    X: =134
                    Y: =5
                    ZIndex: =4

            ContainerJTBD_2 As groupContainer.manualLayoutContainer:
                Height: =438
                Width: =Parent.Width/7.5
                X: |-
                    =ContainerCustomer_2.X-
                    ContainerCustomer_2.Width
                Y: =48
                ZIndex: =3

                LabelBoxJTBD_2 As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =4

                LabelTitleJTBD_2 As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: =_lJTBD
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =5

                LabelDetailJTBD_2 As label:
                    Height: =Parent.Height-LabelTitleCustomer_2.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lJTBDData
                        
                        /**
                        With({_startid:6},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        )
                        */
                    Width: =Parent.Width-20
                    X: =10
                    Y: =50
                    ZIndex: =6

                Icon2_8 As icon.Edit:
                    Height: =38
                    Icon: =Icon.Edit
                    OnSelect: |-
                        =Set(
                            addAnswer,
                            false
                        );
                        Set(
                            addAnswerId,
                            0
                        );
                        
                        
                        //問いへ遷移
                        Set(
                            navigationKey,
                            6
                        );
                        Set(
                            questionKey,
                            6
                        );
                        With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                        Reset(textAnswer);
                        Reset(skipAnswerCheckbox);
                        Reset(noAnswerCheckbox);
                        Set(
                            currentAnswer,
                            If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                            );
                        Set(
                            skipFlag,
                            getAnswerRecord.skip_flag
                            );
                        Set(
                            noAnswerFlag,
                            getAnswerRecord.no_answer_flag
                            );
                        );
                        
                        With({qRecord:LookUp(questionList, ID=questionKey)},
                        Set(
                            currentTitle,
                            qRecord.Title
                        );
                        Set(
                            currentQuestion,
                            qRecord.question_content
                        );
                        Set(currentCategory,qRecord.category);
                        Set(
                            controlType,
                            qRecord.control_type
                        );
                        Set(
                            currentPage,
                            qRecord.current_question_number
                        );
                        Set(
                            totalPage,
                            qRecord.question_totalnumber
                        );
                        Set(
                            commentary,
                            qRecord.commentary
                        );
                        Set(
                            example,
                            qRecord.example
                        );
                        Set(
                            currentRequired,
                            qRecord.required
                        );
                        Set(
                            nextVisible,
                            If(qRecord.next_question_id=0,false,true)
                        
                        );
                        Set(
                            confirmVisible,
                            If(qRecord.next_question_id=0,true,false)
                        );
                        );
                        Set(
                            backVisible,
                            false
                        );
                        Set(
                            commentaryGroupVisible,
                            true
                        );
                        Set(
                            exampleGroupVisible,
                            false
                        );
                        If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                        Navigate(
                            scrennQuestion,
                            ScreenTransition.Fade
                        );
                    Width: =38
                    X: =134
                    Y: =5
                    ZIndex: =7

            ContainerCustomer_2 As groupContainer.manualLayoutContainer:
                Height: =438
                Width: =Parent.Width/7.5
                X: =Parent.Width-ContainerCustomer_2.Width
                Y: =48
                ZIndex: =4

                LabelBoxCustomer_2 As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =7

                LabelTitleCustomer_2 As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: =_lCustomer
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =8

                LabelDetailCustomer_2 As label:
                    Height: =Parent.Height-LabelTitleCustomer_2.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lCustomerData
                        
                        /**
                        With({_startid:3},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+1).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+1).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+2).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+2).answer
                        )
                        */
                    Width: =Parent.Width-20
                    X: =10
                    Y: =50
                    ZIndex: =10

                Icon2_9 As icon.Edit:
                    Height: =38
                    Icon: =Icon.Edit
                    OnSelect: |-
                        =Set(
                            addAnswer,
                            false
                        );
                        Set(
                            addAnswerId,
                            0
                        );
                        
                        
                        //問いへ遷移
                        Set(
                            navigationKey,
                            3
                        );
                        Set(
                            questionKey,
                            3
                        );
                        With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                        Reset(textAnswer);
                        Reset(skipAnswerCheckbox);
                        Reset(noAnswerCheckbox);
                        Set(
                            currentAnswer,
                            If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                            );
                        Set(
                            skipFlag,
                            getAnswerRecord.skip_flag
                            );
                        Set(
                            noAnswerFlag,
                            getAnswerRecord.no_answer_flag
                            );
                        );
                        
                        With({qRecord:LookUp(questionList, ID=questionKey)},
                        Set(
                            currentTitle,
                            qRecord.Title
                        );
                        Set(
                            currentQuestion,
                            qRecord.question_content
                        );
                        Set(currentCategory,qRecord.category);
                        Set(
                            controlType,
                            qRecord.control_type
                        );
                        Set(
                            currentPage,
                            qRecord.current_question_number
                        );
                        Set(
                            totalPage,
                            qRecord.question_totalnumber
                        );
                        Set(
                            commentary,
                            qRecord.commentary
                        );
                        Set(
                            example,
                            qRecord.example
                        );
                        Set(
                            currentRequired,
                            qRecord.required
                        );
                        Set(
                            nextVisible,
                            If(qRecord.next_question_id=0,false,true)
                        
                        );
                        Set(
                            confirmVisible,
                            If(qRecord.next_question_id=0,true,false)
                        );
                        );
                        Set(
                            backVisible,
                            false
                        );
                        Set(
                            commentaryGroupVisible,
                            true
                        );
                        Set(
                            exampleGroupVisible,
                            false
                        );
                        If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                        Navigate(
                            scrennQuestion,
                            ScreenTransition.Fade
                        );
                    Width: =38
                    X: =134
                    Y: =5
                    ZIndex: =11

            IconArrow_4 As icon.ChevronLeft:
                Color: =RGBA(0, 13, 75, 1)
                DisplayMode: =DisplayMode.View
                Height: =Parent.Height-10
                Icon: =Icon.ChevronLeft
                Width: =30
                X: =184
                Y: =10
                ZIndex: =5

            GalleryAddCategory_2 As gallery.variableTemplateHeightGallery:
                Height: =476
                Items: =Sort(Filter('仮説構築支援ツール - 追加の問い',themeID=themeId),sort_order)
                Layout: =Layout.Vertical
                TemplateSize: =400
                Width: =Parent.Width-Parent.Width/7.5*3-IconArrow_4.Width
                X: =199
                Y: =20
                ZIndex: =6

                ContainerAddCategory_2 As groupContainer.horizontalAutoLayoutContainer:
                    Height: =298
                    LayoutGap: =5
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =1
                    PaddingTop: =1
                    Width: =Parent.Width-20
                    ZIndex: =2

                    ContainerVP_2 As groupContainer.manualLayoutContainer:
                        Height: =Parent.Height-10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer_2.Width
                        Width: =LabelBoxCustomer_2.Width
                        ZIndex: =9

                        LabelBoxVP_2 As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Fill: =If(And(_gIsDelete,_gDeleteId=ThisItem.ID),_cBaseColor,RGBA(0, 0, 0, 0))
                            Height: =Parent.Height-50
                            Text: =
                            Width: =LabelBoxCustomer_2.Width
                            X: =1
                            Y: =38
                            ZIndex: =1

                        LabelTitleVP_2 As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lVP&ThisItem.sort_order
                            Width: =Parent.Width
                            Y: =39
                            ZIndex: =2

                        LabelDetailVP_2 As label:
                            Height: =Parent.Height-LabelTitleCustomer_2.Height-60
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colVP,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colVP,Sort(Filter(_cAnswerList,And(themeID=themeId,category="提供価値")),questionID));
                                
                                /**
                                With({_startid:18},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =80
                            ZIndex: =3

                        Icon2_10 As icon.Edit:
                            Height: =38
                            Icon: =Icon.Edit
                            OnSelect: |-
                                =Set(
                                    addAnswer,
                                    true
                                );
                                Set(
                                    addAnswerId,
                                    ThisItem.ID
                                );
                                
                                
                                //問いへ遷移
                                Set(
                                    navigationKey,
                                    18
                                );
                                Set(
                                    questionKey,
                                    18
                                );
                                With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                                Reset(textAnswer);
                                Reset(skipAnswerCheckbox);
                                Reset(noAnswerCheckbox);
                                Set(
                                    currentAnswer,
                                    If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                                    );
                                Set(
                                    skipFlag,
                                    getAnswerRecord.skip_flag
                                    );
                                Set(
                                    noAnswerFlag,
                                    getAnswerRecord.no_answer_flag
                                    );
                                );
                                
                                With({qRecord:LookUp(questionList, ID=questionKey)},
                                Set(
                                    currentTitle,
                                    qRecord.Title
                                );
                                Set(
                                    currentQuestion,
                                    qRecord.question_content
                                );
                                Set(currentCategory,qRecord.category);
                                Set(
                                    controlType,
                                    qRecord.control_type
                                );
                                Set(
                                    currentPage,
                                    qRecord.current_question_number
                                );
                                Set(
                                    totalPage,
                                    qRecord.question_totalnumber
                                );
                                Set(
                                    commentary,
                                    qRecord.commentary
                                );
                                Set(
                                    example,
                                    qRecord.example
                                );
                                Set(
                                    currentRequired,
                                    qRecord.required
                                );
                                Set(
                                    nextVisible,
                                    If(qRecord.next_question_id=0,false,true)
                                
                                );
                                Set(
                                    confirmVisible,
                                    If(qRecord.next_question_id=0,true,false)
                                );
                                );
                                Set(
                                    backVisible,
                                    false
                                );
                                Set(
                                    commentaryGroupVisible,
                                    true
                                );
                                Set(
                                    exampleGroupVisible,
                                    false
                                );
                                If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                                Navigate(
                                    scrennQuestion,
                                    ScreenTransition.Fade
                                );
                            Width: =38
                            X: =132
                            Y: =39
                            ZIndex: =4

                    IconArrow_5 As icon.ChevronLeft:
                        Color: =RGBA(0, 13, 75, 1)
                        DisplayMode: =DisplayMode.View
                        Height: =Parent.Height-10
                        Icon: =Icon.ChevronLeft
                        Width: =30
                        ZIndex: =13

                    ContainerSatisfaction_2 As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer_2.Width
                        Width: =LabelBoxCustomer_2.Width
                        ZIndex: =14

                        LabelBoxSatisfaction_2 As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Fill: =If(And(_gIsDelete,_gDeleteId=ThisItem.ID),_cBaseColor,RGBA(0, 0, 0, 0))
                            Height: =Parent.Height-50
                            Text: =
                            Width: =LabelBoxCustomer_2.Width
                            X: =1
                            Y: =38
                            ZIndex: =1

                        LabelTitleSatisfaction_2 As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lSatisfaction&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =39
                            ZIndex: =2

                        LabelDetailSatisfaction_2 As label:
                            Height: =Parent.Height-LabelTitleCustomer_2.Height-60
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colSatisfaction,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colSatisfaction,Sort(Filter(_cAnswerList,And(themeID=themeId,category="満足状況")),questionID));
                                /**
                                With({_startid:14},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+3).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+3,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =80
                            ZIndex: =3

                        Icon2_11 As icon.Edit:
                            Height: =38
                            Icon: =Icon.Edit
                            OnSelect: |-
                                =Set(
                                    addAnswer,
                                    true
                                );
                                Set(
                                    addAnswerId,
                                    ThisItem.ID
                                );
                                
                                
                                //問いへ遷移
                                Set(
                                    navigationKey,
                                    14
                                );
                                Set(
                                    questionKey,
                                    14
                                );
                                With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                                Reset(textAnswer);
                                Reset(skipAnswerCheckbox);
                                Reset(noAnswerCheckbox);
                                Set(
                                    currentAnswer,
                                    If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                                    );
                                Set(
                                    skipFlag,
                                    getAnswerRecord.skip_flag
                                    );
                                Set(
                                    noAnswerFlag,
                                    getAnswerRecord.no_answer_flag
                                    );
                                );
                                
                                With({qRecord:LookUp(questionList, ID=questionKey)},
                                Set(
                                    currentTitle,
                                    qRecord.Title
                                );
                                Set(
                                    currentQuestion,
                                    qRecord.question_content
                                );
                                Set(currentCategory,qRecord.category);
                                Set(
                                    controlType,
                                    qRecord.control_type
                                );
                                Set(
                                    currentPage,
                                    qRecord.current_question_number
                                );
                                Set(
                                    totalPage,
                                    qRecord.question_totalnumber
                                );
                                Set(
                                    commentary,
                                    qRecord.commentary
                                );
                                Set(
                                    example,
                                    qRecord.example
                                );
                                Set(
                                    currentRequired,
                                    qRecord.required
                                );
                                Set(
                                    nextVisible,
                                    If(qRecord.next_question_id=0,false,true)
                                
                                );
                                Set(
                                    confirmVisible,
                                    If(qRecord.next_question_id=0,true,false)
                                );
                                );
                                Set(
                                    backVisible,
                                    false
                                );
                                Set(
                                    commentaryGroupVisible,
                                    true
                                );
                                Set(
                                    exampleGroupVisible,
                                    false
                                );
                                If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                                Navigate(
                                    scrennQuestion,
                                    ScreenTransition.Fade
                                );
                            Width: =38
                            X: =132
                            Y: =39
                            ZIndex: =4

                    ContainerCurrentMeasures_2 As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer_2.Width
                        Width: =LabelBoxCustomer_2.Width
                        ZIndex: =15

                        LabelBoxCurrentMeasures_2 As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Fill: =If(And(_gIsDelete,_gDeleteId=ThisItem.ID),_cBaseColor,RGBA(0, 0, 0, 0))
                            Height: =Parent.Height-50
                            Text: =
                            Width: =LabelBoxCustomer_2.Width
                            X: =1
                            Y: =38
                            ZIndex: =1

                        LabelTitleCurrentMeasures_2 As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lCurrentMeasures&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =39
                            ZIndex: =2

                        LabelDetailCurrentMeasures_2 As label:
                            Height: =Parent.Height-LabelTitleCustomer_2.Height-60
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colCurrentMeasures,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colCurrentMeasures,Sort(Filter(_cAnswerList,And(themeID=themeId,category="現状対策（代替）")),questionID));
                                
                                
                                /**
                                With({_startid:11},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =80
                            ZIndex: =3

                        Icon2_12 As icon.Edit:
                            Height: =38
                            Icon: =Icon.Edit
                            OnSelect: |-
                                =Set(
                                    addAnswer,
                                    true
                                );
                                Set(
                                    addAnswerId,
                                    ThisItem.ID
                                );
                                
                                
                                //問いへ遷移
                                Set(
                                    navigationKey,
                                    11
                                );
                                Set(
                                    questionKey,
                                    11
                                );
                                With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                                Reset(textAnswer);
                                Reset(skipAnswerCheckbox);
                                Reset(noAnswerCheckbox);
                                Set(
                                    currentAnswer,
                                    If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                                    );
                                Set(
                                    skipFlag,
                                    getAnswerRecord.skip_flag
                                    );
                                Set(
                                    noAnswerFlag,
                                    getAnswerRecord.no_answer_flag
                                    );
                                );
                                
                                With({qRecord:LookUp(questionList, ID=questionKey)},
                                Set(
                                    currentTitle,
                                    qRecord.Title
                                );
                                Set(
                                    currentQuestion,
                                    qRecord.question_content
                                );
                                Set(currentCategory,qRecord.category);
                                Set(
                                    controlType,
                                    qRecord.control_type
                                );
                                Set(
                                    currentPage,
                                    qRecord.current_question_number
                                );
                                Set(
                                    totalPage,
                                    qRecord.question_totalnumber
                                );
                                Set(
                                    commentary,
                                    qRecord.commentary
                                );
                                Set(
                                    example,
                                    qRecord.example
                                );
                                Set(
                                    currentRequired,
                                    qRecord.required
                                );
                                Set(
                                    nextVisible,
                                    If(qRecord.next_question_id=0,false,true)
                                
                                );
                                Set(
                                    confirmVisible,
                                    If(qRecord.next_question_id=0,true,false)
                                );
                                );
                                Set(
                                    backVisible,
                                    false
                                );
                                Set(
                                    commentaryGroupVisible,
                                    true
                                );
                                Set(
                                    exampleGroupVisible,
                                    false
                                );
                                If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                                Navigate(
                                    scrennQuestion,
                                    ScreenTransition.Fade
                                );
                            Width: =38
                            X: =132
                            Y: =39
                            ZIndex: =4

                    ContainerHindranceFactor_2 As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer_2.Width
                        Width: =LabelBoxCustomer_2.Width
                        ZIndex: =16

                        LabelBoxHindranceFactor_2 As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Fill: =If(And(_gIsDelete,_gDeleteId=ThisItem.ID),_cBaseColor,RGBA(0, 0, 0, 0))
                            Height: =Parent.Height-50
                            Text: =
                            Width: =LabelBoxCustomer_2.Width
                            X: =1
                            Y: =39
                            ZIndex: =1

                        LabelTitleHindranceFactor_2 As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lHindranceFactor&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =39
                            ZIndex: =2

                        LabelDetailHindranceFactor_2 As label:
                            Height: =Parent.Height-LabelTitleCustomer_2.Height-60
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colHindranceFactor,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colHindranceFactor,Sort(Filter(_cAnswerList,And(themeID=themeId,category="阻害要因（課題）")),questionID));
                                /**
                                With({_startid:7},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+3).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+3,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =80
                            ZIndex: =3

                        Icon2_13 As icon.Edit:
                            Height: =38
                            Icon: =Icon.Edit
                            OnSelect: |-
                                =Set(
                                    addAnswer,
                                    true
                                );
                                Set(
                                    addAnswerId,
                                    ThisItem.ID
                                );
                                
                                
                                //問いへ遷移
                                Set(
                                    navigationKey,
                                    7
                                );
                                Set(
                                    questionKey,
                                    7
                                );
                                With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                                Reset(textAnswer);
                                Reset(skipAnswerCheckbox);
                                Reset(noAnswerCheckbox);
                                Set(
                                    currentAnswer,
                                    If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                                    );
                                Set(
                                    skipFlag,
                                    getAnswerRecord.skip_flag
                                    );
                                Set(
                                    noAnswerFlag,
                                    getAnswerRecord.no_answer_flag
                                    );
                                );
                                
                                With({qRecord:LookUp(questionList, ID=questionKey)},
                                Set(
                                    currentTitle,
                                    qRecord.Title
                                );
                                Set(
                                    currentQuestion,
                                    qRecord.question_content
                                );
                                Set(currentCategory,qRecord.category);
                                Set(
                                    controlType,
                                    qRecord.control_type
                                );
                                Set(
                                    currentPage,
                                    qRecord.current_question_number
                                );
                                Set(
                                    totalPage,
                                    qRecord.question_totalnumber
                                );
                                Set(
                                    commentary,
                                    qRecord.commentary
                                );
                                Set(
                                    example,
                                    qRecord.example
                                );
                                Set(
                                    currentRequired,
                                    qRecord.required
                                );
                                Set(
                                    nextVisible,
                                    If(qRecord.next_question_id=0,false,true)
                                
                                );
                                Set(
                                    confirmVisible,
                                    If(qRecord.next_question_id=0,true,false)
                                );
                                );
                                Set(
                                    backVisible,
                                    false
                                );
                                Set(
                                    commentaryGroupVisible,
                                    true
                                );
                                Set(
                                    exampleGroupVisible,
                                    false
                                );
                                If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                                Navigate(
                                    scrennQuestion,
                                    ScreenTransition.Fade
                                );
                            Width: =38
                            X: =132
                            Y: =39
                            ZIndex: =4

                IconDelete_2 As icon.CancelBadge:
                    Color: =_cBaseColor
                    DisabledColor: =_cBaseColor
                    Height: =30
                    Icon: =Icon.CancelBadge
                    OnSelect: |-
                        =Set(_gDeleteId,ThisItem.ID);
                        Set(_gIsDelete,true);
                        Set(_gDeleteSortOrder,ThisItem.sort_order);
                    Tooltip: ="追加した回答行を削除"
                    Visible: =If(CountRows(Filter('仮説構築支援ツール - 追加の問い',themeID=themeId).ID)=1, false, true)
                    Width: =30
                    X: =10.600000000000023
                    ZIndex: =3

                ButtonAddQuestion_2 As button:
                    BorderThickness: =1
                    Color: =_cBaseColor
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =ColorFade(_cBaseColor, 20%)
                    Fill: =RGBA(245,245,245,1)
                    FocusedBorderColor: =ColorFade(_cBaseColor, 20%)
                    FocusedBorderThickness: =1
                    FontWeight: =Normal
                    Height: =70
                    HoverBorderColor: =ColorFade(_cBaseColor, 20%)
                    HoverFill: =ColorFade(_cBaseColor, 20%)
                    OnSelect: |-
                        =Collect('仮説構築支援ツール - 追加の問い',{themeID:themeId,sort_order:_gMaxSortNumber+1});
                        Set(_gMaxSortNumber,_gMaxSortNumber+1);
                    PaddingBottom: =10
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =ColorFade(_cBaseColor, 20%)
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =24
                    Text: ="＋追加"
                    Visible: =If(And(_gMaxSortNumber=ThisItem.sort_order,_gMaxSortNumber<5),true)
                    Width: =769
                    Y: =300
                    ZIndex: =4

                IconDown_2 As icon.Hamburger:
                    Color: =_cBaseColor
                    DisabledColor: =_cBaseColor
                    Height: =30
                    Icon: =Icon.BackArrow
                    OnSelect: |-
                        =UpdateIf('仮説構築支援ツール - 追加の問い',And(themeID=themeId,sort_order=ThisItem.sort_order+1),{sort_order:ThisItem.sort_order},ID=ThisItem.ID,{sort_order:ThisItem.sort_order+1});
                        //UpdateIf('仮説構築支援ツール - 追加の問い',ID=ThisItem.ID,{sort_order:ThisItem.sort_order+1});
                    Rotation: =-90
                    Tooltip: ="回答行を下に移動"
                    Visible: =If(ThisItem.sort_order=First(Sort(Filter('仮説構築支援ツール - 追加の問い',themeID=themeId),sort_order,Descending)).sort_order, false, true)
                    Width: =30
                    X: =720
                    ZIndex: =5

                IconUp_2 As icon.Hamburger:
                    Color: =_cBaseColor
                    DisabledColor: =_cBaseColor
                    Height: =30
                    Icon: =Icon.NextArrow
                    OnSelect: |-
                        =UpdateIf('仮説構築支援ツール - 追加の問い', And(themeID=themeId,sort_order=ThisItem.sort_order-1), {sort_order:ThisItem.sort_order},ID=ThisItem.ID,{sort_order:ThisItem.sort_order-1});
                        //UpdateIf('仮説構築支援ツール - 追加の問い',ID=ThisItem.ID,{sort_order:ThisItem.sort_order-1});
                    Rotation: =-90
                    Tooltip: ="回答行を上に移動"
                    Visible: =If(ThisItem.sort_order=1, false, true)
                    Width: =30
                    X: =670
                    ZIndex: =6

        GroupDeleteConfirm_2 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =-287
            ZIndex: =58

            Rectangle1_4 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0.2)
                Height: =640
                Visible: =If(_gIsDelete,true,false)
                Width: =Max(App.Width, App.MinScreenWidth)
                ZIndex: =4

            RectangleDialog_2 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =
                Fill: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =0
                Height: =270
                Visible: =If(_gIsDelete,true,false)
                Width: =500
                X: =(App.Width/2)-(Self.Width/2)
                Y: =Rectangle1_4.Height/3
                ZIndex: =5

            LabelConfirmMessage_2 As label:
                Align: =Left
                Color: =RGBA(116, 116, 116, 1)
                FontWeight: =Normal
                Height: =103
                Size: =12
                Text: |-
                    ="この行を削除すると登録した回答も削除されます。
                    この操作を元に戻すことはできません。
                    続行しますか？"
                Visible: =If(_gIsDelete,true,false)
                Width: =470
                X: =443
                Y: =296
                ZIndex: =6

            ButtonDelete_2 As button:
                BorderThickness: =0
                Fill: =RGBA(203, 102, 102, 1)
                FocusedBorderThickness: =0
                Height: =35
                HoverFill: =ColorFade(Self.Fill,-20%)
                OnSelect: |-
                    =With({answerRecord:Filter('仮説構築支援ツール - 回答',add_answerID=_gDeleteId)},
                    If(
                        Not(IsBlank(answerRecord)),
                        Remove('仮説構築支援ツール - 回答',answerRecord);
                    );
                    );
                    Remove('仮説構築支援ツール - 追加の問い',LookUp('仮説構築支援ツール - 追加の問い',ID=_gDeleteId));
                    UpdateIf('仮説構築支援ツール - 追加の問い',And(themeID=themeId,sort_order>_gDeleteSortOrder),{sort_order:sort_order-1});
                    Set(_gIsDelete,false);
                    Set(_gMaxSortNumber,_gMaxSortNumber-1);
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =14
                Text: ="削除"
                Visible: =If(_gIsDelete,true,false)
                Width: =100
                X: =692
                Y: =430
                ZIndex: =7

            ButtonCancel_2 As button:
                BorderThickness: =1
                Color: =RGBA(0, 0, 0, 1)
                Fill: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =1
                Height: =35
                HoverColor: =RGBA(0, 0, 0, 1)
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: =Set(_gIsDelete,false)
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =12
                Text: ="キャンセル"
                Visible: =If(_gIsDelete,true,false)
                Width: =100
                X: =817
                Y: =430
                ZIndex: =8

            LabelDeleteTitle_2 As label:
                Align: =Left
                Color: =RGBA(0, 13, 75, 1)
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =20
                Text: |-
                    ="追加した行を削除しますか？
                    "
                Visible: =If(_gIsDelete,true,false)
                Width: =425
                X: =443
                Y: =230
                ZIndex: =9

