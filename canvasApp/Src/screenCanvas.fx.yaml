screenCanvas As screen:
    OnVisible: |
        =Set(navigationKey,0);
        Set(currentCategory,"");
        Set(answerList,'仮説構築支援ツール - 回答');
        Set(themeId,galleryTheme.Selected.ID);
        Set(pageKey,"canvas");

    MainContainer2 As groupContainer.manualLayoutContainer:
        Height: =Max(App.Height, App.MinScreenHeight)
        Width: =Max(App.Width, App.MinScreenWidth)
        ZIndex: =38

        cmHeader_2 As cmHeader:

        BodyContainer1 As groupContainer.manualLayoutContainer:
            Height: =MainContainer.Height-cmHeader_1.Height-HeaderContainer.Height-FooterContainer_1.Height
            Width: =Max(App.Width, App.MinScreenWidth)-NavigateContainer.Width
            Y: =cmHeader_1.Height+HeaderContainer.Height
            ZIndex: =2

            cmHome_1 As cmHome:
                Height: =562
                moveQuestion: |-
                    =If(addAnswerFlag,
                    With(
                        {
                            getAnswerRecord: LookUp(
                                '仮説構築支援ツール - 回答',
                                And(
                                    themeID = themeId,
                                    questionID = questionKey,
                                    add_answerID = addAnswerId
                                )
                            )
                        },
                        If(IsBlank(getAnswerRecord),
                        Patch('仮説構築支援ツール - 回答',
                        Defaults('仮説構築支援ツール - 回答'),
                        {
                            themeID: themeId,
                            questionID: qid,
                            category: addCategory,
                            answer:"",
                            skip_flag: false,
                            no_answer_flag:false,
                            status:0,
                            add_answerID:addAnswerId
                        }
                        )
                    
                    ));
                    Set(addAnswer,true);
                    Set(addAnswerId,addAnswerId),
                    Set(addAnswerId,0));
                    
                    
                    //問いへ遷移
                    Set(
                        navigationKey,
                        qid
                    );
                    Set(
                        questionKey,
                        qid
                    );
                    With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                    Reset(textAnswer);
                    Reset(skipAnswerCheckbox);
                    Reset(noAnswerCheckbox);
                    Set(
                        currentAnswer,
                        If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                        );
                    Set(
                        skipFlag,
                        getAnswerRecord.skip_flag
                        );
                    Set(
                        noAnswerFlag,
                        getAnswerRecord.no_answer_flag
                        );
                    );
                    
                    With({qRecord:LookUp(questionList, ID=questionKey)},
                    Set(
                        currentTitle,
                        qRecord.Title
                    );
                    Set(
                        currentQuestion,
                        qRecord.question_content
                    );
                    Set(currentCategory,qRecord.category);
                    Set(
                        controlType,
                        qRecord.control_type
                    );
                    Set(
                        currentPage,
                        qRecord.current_question_number
                    );
                    Set(
                        totalPage,
                        qRecord.question_totalnumber
                    );
                    Set(
                        commentary,
                        qRecord.commentary
                    );
                    Set(
                        example,
                        qRecord.example
                    );
                    Set(
                        currentRequired,
                        qRecord.required
                    );
                    Set(
                        nextVisible,
                        If(qRecord.next_question_id=0,false,true)
                    
                    );
                    Set(
                        confirmVisible,
                        If(qRecord.next_question_id=0,true,false)
                    );
                    );
                    Set(
                        backVisible,
                        false
                    );
                    Set(
                        commentaryGroupVisible,
                        true
                    );
                    Set(
                        exampleGroupVisible,
                        false
                    );
                    If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                    Navigate(
                        scrennQuestion,
                        ScreenTransition.Fade
                    );
                ZIndex: =3

        NavigateContainer As groupContainer.manualLayoutContainer:
            Height: =BodyContainer1.Height
            Width: =MainContainer2.Width/6
            X: =MainContainer2.Width-MainContainer2.Width/6
            Y: =BodyContainer1.Y
            ZIndex: =4

            cmNavigation_1 As cmNavigation:
                Height: =455
                setQuestionValue: |-
                    =Set(
                        navigationKey,
                        qId
                    );
                    Set(
                        questionKey,
                        qId
                    );
                    With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey))},
                    Reset(textAnswer);
                    Reset(skipAnswerCheckbox);
                    Reset(noAnswerCheckbox);
                    Set(
                        currentAnswer,
                        If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                        );
                    Set(
                        skipFlag,
                        getAnswerRecord.skip_flag
                        );
                    Set(
                        noAnswerFlag,
                        getAnswerRecord.no_answer_flag
                        );
                    );
                    
                    With({qRecord:LookUp(questionList, ID=questionKey)},
                    Set(
                        currentTitle,
                        qRecord.Title
                    );
                    Set(
                        currentQuestion,
                        qRecord.question_content
                    );
                    Set(currentCategory,qRecord.category);
                    Set(
                        controlType,
                        qRecord.control_type
                    );
                    Set(
                        currentPage,
                        qRecord.current_question_number
                    );
                    Set(
                        totalPage,
                        qRecord.question_totalnumber
                    );
                    Set(
                        commentary,
                        qRecord.commentary
                    );
                    Set(
                        example,
                        qRecord.example
                    );
                    Set(
                        currentRequired,
                        qRecord.required
                    );
                    Set(
                        nextVisible,
                        If(qRecord.next_question_id=0,false,true)
                    
                    );
                    Set(
                        confirmVisible,
                        If(qRecord.next_question_id=0,true,false)
                    );
                    );
                    Set(
                        backVisible,
                        false
                    );
                    Set(
                        commentaryGroupVisible,
                        true
                    );
                    Set(
                        exampleGroupVisible,
                        false
                    );
                    If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")))
                ZIndex: =1

        HeaderContainer As groupContainer.manualLayoutContainer:
            Height: =66
            Width: =MainContainer2.Width
            Y: =cmHeader_2.Height
            ZIndex: =6

            lineContainer2_1 As groupContainer.verticalAutoLayoutContainer:
                Height: =66
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                Width: =HeaderContainer.Width
                X: =30
                ZIndex: =1

                Label2_3 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =44
                    Size: =16
                    Text: ="Ｑ&Ａフローシステム"
                    Width: =400
                    X: =50
                    Y: =461
                    ZIndex: =1

                Rectangle3_3 As rectangle:
                    BorderColor: =_cBaseColor
                    Fill: =_cBaseColor
                    Height: =4
                    Width: =Max(App.Width-60, App.MinScreenWidth-60)
                    X: =50
                    Y: =505
                    ZIndex: =2

            statusBar_2 As cmStatusBar:
                Width: =600
                X: =HeaderContainer.Width/3
                ZIndex: =2

        FooterContainer_1 As groupContainer.manualLayoutContainer:
            Height: =70
            Width: =Max(App.Width, App.MinScreenWidth)-NavigateContainer.Width
            Y: =MainContainer.Height-70
            ZIndex: =7

            ContainerFooter As groupContainer.horizontalAutoLayoutContainer:
                Height: =FooterContainer_1.Height-20
                LayoutGap: =50
                LayoutMode: =LayoutMode.Auto
                Width: =FooterContainer_1.Width
                X: =20
                Y: =20
                ZIndex: =6

                IconBackThemeScreen As icon.BackArrow:
                    Color: =_cBaseColor
                    Height: =30
                    Icon: =Icon.BackArrow
                    OnSelect: =Navigate(screenTheme,Fade)
                    Tooltip: ="テーマ一覧へ戻る"
                    Width: =30
                    ZIndex: =1

                ButtonEntireDisplay As button:
                    BorderColor: =_cBaseColor
                    BorderThickness: =0
                    Fill: =_cBaseColor
                    FocusedBorderColor: =ColorFade(_cBaseColor,-20%)
                    Height: =30
                    HoverFill: =ColorFade(_cBaseColor,-20%)
                    OnSelect: =Navigate(ScreenEntireDisplay)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =ColorFade(_cBaseColor,-20%)
                    RadiusBottomLeft: =20
                    RadiusBottomRight: =20
                    RadiusTopLeft: =20
                    RadiusTopRight: =20
                    Text: ="全体表示"
                    Width: =200
                    X: =111
                    ZIndex: =2

                ButtonEntireDisplay_2 As button:
                    BorderColor: =_cBaseColor
                    BorderThickness: =0
                    Fill: =_cBaseColor
                    Height: =30
                    HoverFill: =ColorFade(_cBaseColor,-20%)
                    OnSelect: =
                    RadiusBottomLeft: =20
                    RadiusBottomRight: =20
                    RadiusTopLeft: =20
                    RadiusTopRight: =20
                    Text: ="出力"
                    Width: =200
                    X: =111
                    Y: =
                    ZIndex: =3

