cmNavigation As CanvasComponent:
    setQuestionValue(qId As Number):
        qId:
            Default: =100
        ThisProperty:
            Default: |-
                =Set(
                    navigationKey,
                    qId
                );
                Set(
                    questionKey,
                    qId
                );
                With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey))},
                Reset(textAnswer);
                Reset(Checkbox1);
                Reset(Checkbox3);
                Set(
                    currentAnswer,
                    If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                    );
                Set(
                    skipFlag,
                    getAnswerRecord.skip_flag
                    );
                Set(
                    noAnswerFlag,
                    getAnswerRecord.no_answer_flag
                    );
                );
                
                With({qRecord:LookUp(questionList, ID=questionKey)},
                Set(
                    currentTitle,
                    qRecord.Title
                );
                Set(
                    currentQuestion,
                    qRecord.question_content
                );
                Set(
                    controlType,
                    qRecord.control_type
                );
                Set(
                    currentPage,
                    qRecord.current_question_number
                );
                Set(
                    totalPage,
                    qRecord.question_totalnumber
                );
                Set(
                    commentary,
                    qRecord.commentary
                );
                Set(
                    example,
                    qRecord.example
                );
                Set(
                    currentRequired,
                    qRecord.required
                );
                Set(
                    nextVisible,
                    If(qRecord.next_question_id=0,false,true)
                
                );
                Set(
                    confirmVisible,
                    If(qRecord.next_question_id=0,true,false)
                );
                );
                Set(
                    backVisible,
                    false
                );
                Set(
                    commentaryGroupVisible,
                    true
                );
                Set(
                    exampleGroupVisible,
                    false
                );
                If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")))
    Fill: =RGBA(0, 0, 0, 0)
    Height: =350
    updateAnswer: |
        =If(
            controlType = "text",
            Set(
                answerContent,
                textAnswer.Text
            ),
            Set(
                answerContent,
                Radio1.Selected.Result
            )
        );
        If(
            Not(
                And(
                    answerContent = currentAnswer,
                    skipFlag = Checkbox1.Value,
                    noAnswerFlag = Checkbox3.Value
                )
            ),
            With(
                {
                    getAnswerRecord: LookUp(
                        '仮説構築支援ツール - 回答',
                        And(
                            themeID = themeId,
                            questionID = questionKey
                        )
                    )
                },
                If(
                    IsBlank(getAnswerRecord),
                    Patch(
                        '仮説構築支援ツール - 回答',
                        Defaults('仮説構築支援ツール - 回答'),
                        {
                            themeID: themeId,
                            questionID: questionKey,
                            answer: answerContent,
                            skip_flag: Checkbox1.Value,
                            no_answer_flag: Checkbox3.Value
                        }
                    );
                    ,
                    Patch(
                        '仮説構築支援ツール - 回答',
                        getAnswerRecord,
                        {
                            answer: answerContent,
                            skip_flag: Checkbox1.Value,
                            no_answer_flag: Checkbox3.Value
                        }
                    );
                )
            )
        );
    Width: =200
    X: =0
    Y: =0
    ZIndex: =5

    "navigateGallery As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        Height: =360
        Items: =navigationList
        Layout: =Layout.Vertical
        TemplateFill: |
            =If(ThisItem.question_id = navigationKey,baseColor,White)
        TemplatePadding: =0
        TemplateSize: =40
        Width: =179
        X: =10
        Y: =10
        ZIndex: =3

        navigateButton As button:
            BorderColor: =baseColor
            Color: =If(ThisItem.question_id = navigationKey,White,baseColor)
            DisabledBorderColor: =baseColor
            Fill: =RGBA(0, 0, 0, 0)
            Height: =navigateGallery.TemplateHeight
            HoverFill: =baseColor
            OnSelect: |
                =cmNavigation.updateAnswer();
                Navigate(
                    scrennQuestion,
                    ScreenTransition.Fade
                );
                cmNavigation.setQuestionValue(ThisItem.question_id);
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =11
            Text: =ThisItem.Title
            Width: =navigateGallery.TemplateWidth
            ZIndex: =6

