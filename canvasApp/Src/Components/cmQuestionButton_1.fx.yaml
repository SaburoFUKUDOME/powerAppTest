cmQuestionButton_1 As CanvasComponent:
    getStatus(answerContent As String, nowSkipFlag As Boolean, nowNoAnswerFlag As Boolean):
        answerContent:
            Default: ="テキスト"
        nowSkipFlag:
            Default: =true
        nowNoAnswerFlag:
            Default: =true
        ThisProperty:
            Default: =
    setQuestionValue(qId As Number, buttonKey As String):
        qId:
            Default: =100
        buttonKey:
            Default: ="テキスト"
        ThisProperty:
            Default: |+
                =With({qRecord:LookUp(questionList, ID=qId)},
                Set(
                    currentTitle,
                    qRecord.Title
                );
                Set(
                    currentQuestion,
                    qRecord.question_content
                );
                
                Set(
                    currentPage,
                    qRecord.current_question_number
                );
                Set(
                    totalPage,
                    qRecord.question_totalnumber
                );
                Set(
                    commentary,
                    qRecord.commentary
                );
                Set(
                    example,
                    qRecord.example
                );
                Set(
                    controlType,
                    qRecord.control_type
                );
                Set(
                    currentRequired,
                    qRecord.required
                );
                Set(currentCategory,qRecord.category);
                
                If(buttonKey="next",
                //次へボタンの場合
                Set(
                    nextVisible,
                    If(qRecord.next_question_id=0,false,true)
                );
                Set(
                    backVisible,
                    true
                );,
                //戻るボタンの場合
                Set(
                    nextVisible,
                    true
                );
                Set(
                    backVisible,
                     If(qRecord.back_question_id=0,false,true)
                ););
                
                Set(
                    confirmVisible,
                    If(qRecord.next_question_id=0,true,false)
                );
                
                With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=qId))},
                Reset(textAnswer);
                Reset(skipAnswerCheckbox);
                Reset(noAnswerCheckbox);
                Set(
                    currentAnswer,
                    If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                    );
                Set(
                    skipFlag,
                    getAnswerRecord.skip_flag
                    );
                Set(
                    noAnswerFlag,
                    getAnswerRecord.no_answer_flag
                    );
                );
                 
                
                Set(questionKey,qId);
                Set(
                    commentaryGroupVisible,
                    true
                );
                Set(
                    exampleGroupVisible,
                    false
                );
                If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")))
                )
                
    Fill: =RGBA(0, 0, 0, 0)
    Height: =Max(App.Height, App.MinScreenHeight)
    updateAnswer: |-
        =If(
            controlType = "text",
            Set(
                answerContent,
                textAnswer.Text
            ),
            Set(
                answerContent,
                Radio1.Selected.Result
            )
        );
        With(
            {
                getAnswerRecord: LookUp(
                    '仮説構築支援ツール - 回答',
                    And(
                        themeID = themeId,
                        questionID = questionKey
                    )
                ),
                status: If(
                    skipAnswerCheckbox.Value,
                    2,
                    !IsBlank(answerContent),
                    10,
                    And(
                        currentRequired = "2",
                        noAnswerCheckbox.Value
                    ),
                    10,
                    0
                )
            },
            If(
                IsBlank(getAnswerRecord),
                Patch(
                    '仮説構築支援ツール - 回答',
                    Defaults('仮説構築支援ツール - 回答'),
                    {
                        themeID: themeId,
                        questionID: questionKey,
                        category: currentCategory,
                        answer: answerContent,
                        skip_flag: skipAnswerCheckbox.Value,
                        no_answer_flag: noAnswerCheckbox.Value,
                        status: status
                    }
                );
                ,
                If(
                    Not(
                        And(
                            answerContent = currentAnswer,
                            skipFlag = skipAnswerCheckbox.Value,
                            noAnswerFlag = noAnswerCheckbox.Value
                        )
                    ),
                    Patch(
                        '仮説構築支援ツール - 回答',
                        getAnswerRecord,
                        {
                            answer: answerContent,
                            skip_flag: skipAnswerCheckbox.Value,
                            no_answer_flag: noAnswerCheckbox.Value,
                            status: status
                        }
                    );
                )
            );
        )
    Width: =Max(App.Width, App.MinScreenWidth)
    X: =0
    Y: =0
    ZIndex: =2

    buttonContainer As groupContainer.manualLayoutContainer:
        Height: =70
        X: =500
        Y: =MainContainer.Height-70
        ZIndex: =5

        qButtonGroup_2 As group:
            Height: =5
            Width: =5
            X: =-230
            Y: =-8
            ZIndex: =4

            backButton_2 As button:
                BorderColor: =baseColor
                BorderStyle: =BorderStyle.None
                DisabledBorderColor: =baseColor
                DisabledColor: =baseColor
                DisabledFill: =baseColor
                Fill: =baseColor
                Height: =35
                HoverBorderColor: =ColorFade(baseColor, 20%)
                HoverFill: =ColorFade(baseColor,-20%)
                OnSelect: |
                    =cmQuestionButton_1.updateAnswer();
                    cmQuestionButton_1.setQuestionValue(LookUp(questionList, ID=questionKey).back_question_id,"back");
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =14
                Text: ="　↑　戻る"
                Visible: =backVisible
                Y: =8
                ZIndex: =1

            nextButton_2 As button:
                BorderColor: =baseColor
                BorderStyle: =BorderStyle.None
                DisabledBorderColor: =baseColor
                DisabledColor: =baseColor
                DisabledFill: =baseColor
                Fill: =baseColor
                Height: =backButton_2.Height
                HoverBorderColor: =ColorFade(baseColor, 20%)
                HoverFill: =ColorFade(baseColor,-20%)
                OnSelect: |-
                    =cmQuestionButton_1.updateAnswer();
                    cmQuestionButton_1.setQuestionValue(LookUp(questionList, ID=questionKey).next_question_id,"next");
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =14
                Text: ="　↓　次へ"
                Visible: =nextVisible
                Width: =backButton_2.Width
                X: =backButton_2.Width+30
                Y: =backButton_2.Y
                ZIndex: =2

            confirmButton_2 As button:
                BorderColor: =baseColor
                BorderStyle: =BorderStyle.None
                DisabledBorderColor: =baseColor
                DisabledColor: =baseColor
                DisabledFill: =baseColor
                Fill: =baseColor
                Height: =nextButton_2.Height
                HoverBorderColor: =ColorFade(baseColor, 20%)
                HoverFill: =ColorFade(baseColor,-20%)
                OnSelect: |
                    =
                    //　更新処理する
                    cmQuestionButton_1.updateAnswer();
                    Navigate(
                        screenCanvas,
                        ScreenTransition.Fade
                    );
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =14
                Text: ="確定"
                Visible: =confirmVisible
                Width: =nextButton_2.Width
                X: =nextButton_2.X
                Y: =nextButton_2.Y
                ZIndex: =3

    Container5 As groupContainer.manualLayoutContainer:
        Height: =644
        Width: =344
        X: =1020
        Y: =28
        ZIndex: =7

        "navigateGallery_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            Height: =360
            Items: =navigationList
            Layout: =Layout.Vertical
            TemplateFill: |
                =If(ThisItem.question_id = navigationKey,baseColor,White)
            TemplatePadding: =0
            TemplateSize: =40
            Width: =212
            X: =40
            Y: =40
            ZIndex: =1

            navigateButton_2 As button:
                BorderColor: =baseColor
                Color: =If(ThisItem.question_id = navigationKey,White,baseColor)
                DisabledBorderColor: =baseColor
                Fill: =RGBA(0, 0, 0, 0)
                Height: =navigateGallery_2.TemplateHeight
                HoverFill: =baseColor
                OnSelect: |
                    =//問画面の場合のみ、答えを更新する
                    If(pageKey ="question",cmQuestionButton_1.updateAnswer(),Navigate(
                        scrennQuestion,
                        ScreenTransition.Fade
                    );); 
                    cmQuestionButton_1.setQuestionValue(ThisItem.question_id,"");
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Text: =ThisItem.Title
                Width: =navigateGallery_2.TemplateWidth
                ZIndex: =6

