cmHome_2 As CanvasComponent:
    moveQuestion(qid As Number, addAnswerFlag As Boolean, addAnswerId As Number, addCategory As String):
        qid:
            Default: =100
        addAnswerFlag:
            Default: =true
        addAnswerId:
            Default: =100
        addCategory:
            Default: ="テキスト"
        ThisProperty:
            Default: |-
                =If(
                    addAnswerFlag,
                    Set(
                        addAnswer,
                        true
                    );
                    Set(
                        addAnswerId,
                        addAnswerId
                    ),
                    Set(
                        addAnswerId,
                        0
                    )
                );
                
                
                //問いへ遷移
                Set(
                    navigationKey,
                    qid
                );
                Set(
                    questionKey,
                    qid
                );
                With({getAnswerRecord:LookUp('仮説構築支援ツール - 回答',And(themeID=themeId,questionID=questionKey,add_answerID=addAnswerId))},
                Reset(textAnswer);
                Reset(skipAnswerCheckbox);
                Reset(noAnswerCheckbox);
                Set(
                    currentAnswer,
                    If(IsBlank(getAnswerRecord),"",getAnswerRecord.answer)
                    );
                Set(
                    skipFlag,
                    getAnswerRecord.skip_flag
                    );
                Set(
                    noAnswerFlag,
                    getAnswerRecord.no_answer_flag
                    );
                );
                
                With({qRecord:LookUp(questionList, ID=questionKey)},
                Set(
                    currentTitle,
                    qRecord.Title
                );
                Set(
                    currentQuestion,
                    qRecord.question_content
                );
                Set(currentCategory,qRecord.category);
                Set(
                    controlType,
                    qRecord.control_type
                );
                Set(
                    currentPage,
                    qRecord.current_question_number
                );
                Set(
                    totalPage,
                    qRecord.question_totalnumber
                );
                Set(
                    commentary,
                    qRecord.commentary
                );
                Set(
                    example,
                    qRecord.example
                );
                Set(
                    currentRequired,
                    qRecord.required
                );
                Set(
                    nextVisible,
                    If(qRecord.next_question_id=0,false,true)
                
                );
                Set(
                    confirmVisible,
                    If(qRecord.next_question_id=0,true,false)
                );
                );
                Set(
                    backVisible,
                    false
                );
                Set(
                    commentaryGroupVisible,
                    true
                );
                Set(
                    exampleGroupVisible,
                    false
                );
                If(Not(currentRequired="2"),Set(currentQuestion,Concatenate(currentQuestion,"*")));
                Navigate(
                    scrennQuestion,
                    ScreenTransition.Fade
                );
    Fill: =RGBA(0, 0, 0, 0)
    Height: =640
    Width: =Max(App.Width, App.MinScreenWidth)
    X: =0
    Y: =0
    ZIndex: =4

    ContainerMain_2 As groupContainer.manualLayoutContainer:
        Height: =640
        Width: =Max(App.Width, App.MinScreenWidth)
        ZIndex: =2

        ContainerFooter3_2 As groupContainer.manualLayoutContainer:
            Height: =50
            Width: =Parent.Width
            Y: =590
            ZIndex: =2

            IconBackThemeScreen_4 As icon.BackArrow:
                Color: =_cBaseColor
                Height: =30
                Icon: =Icon.BackArrow
                OnSelect: =Navigate(screenTheme,Fade)
                Tooltip: ="Home画面へ戻る"
                Width: =30
                X: =11
                Y: =10
                ZIndex: =2

            Label3_3 As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =16
                LineHeight: =1.0
                Size: =11
                Text: ="©New*New All rights reserved."
                Width: =268
                X: =515
                Y: =24
                ZIndex: =4

            ButtonDLCsv_2 As button:
                BorderColor: =_cBaseColor
                BorderThickness: =0
                Fill: =_cBaseColor
                FocusedBorderColor: =ColorFade(_cBaseColor,-20%)
                FocusedBorderThickness: =0
                FontWeight: =Semibold
                Height: =30
                HoverBorderColor: =ColorFade(_cBaseColor,-20%)
                HoverFill: =ColorFade(_cBaseColor,-20%)
                OnSelect: |-
                    =// 追加の問を連結したコレクションを作成
                    Clear(colOutputTextCSV);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextCSV, 
                    {addId:_addId,text:Concat(Filter(colHindranceFactor,add_answerID=_addId),"【"&_lHindranceFactor&Value&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&Substitute(answer,"""","""""")&""""&_lNewLine)},
                    {addId:_addId,text:Concat(Filter(colCurrentMeasures,add_answerID=_addId),"【"&_lCurrentMeasures&Value&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&Substitute(answer,"""","""""")&""""&_lNewLine)},
                    {addId:_addId,text:Concat(Filter(colSatisfaction,add_answerID=_addId),"【"&_lSatisfaction&Value&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&Substitute(answer,"""","""""")&""""&_lNewLine)},
                    {addId:_addId,text:Concat(Filter(colVP,add_answerID=_addId),"【"&_lVP&Value&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&Substitute(answer,"""","""""")&""""&_lNewLine)}
                    ))
                    );
                    
                    
                    // 出力文字の連結
                    Set(ExportDataCSV,
                    Concat(colCustomer,"【"&_lCustomer&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&Substitute(answer,"""","""""")&""""&_lNewLine)&
                    Concat(colJTBD,"【"&_lJTBD&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&Substitute(answer,"""","""""")&""""&_lNewLine)&
                    Concat(colOutputTextCSV,text)&
                    Concat(colMVP,"【"&_lMVP&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&Substitute(answer,"""","""""")&""""&_lNewLine));
                    
                    Set(result, csvDL.Run("HypothesisCreator_"& Text(Now(),"yyyymmddhhmm"),ExportDataCSV,_cSharePointLink));
                    Download(_cSharePointLink&result.path);
                    Notify("CSVファイルをダウンロードしました。", NotificationType.Information);
                PressedBorderColor: =ColorFade(_cBaseColor,-20%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(_cBaseColor,-20%)
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =14
                Text: ="CSV出力"
                Tooltip: ="回答のCSVファイルをダウンロード"
                Width: =150
                X: =1199
                Y: =10
                ZIndex: =5

        ContainerCanvas_2 As groupContainer.manualLayoutContainer:
            Height: =Parent.Height-ContainerFooter3_2.Height-ContainerHeader_2.Height-50
            Width: =Parent.Width
            Y: =ContainerHeader_2.Height+50
            ZIndex: =3

            ContainerMVP_2 As groupContainer.manualLayoutContainer:
                Height: =438
                Width: =Parent.Width/7.5
                X: =5
                Y: =38
                ZIndex: =1

                LabelBoxMVP_2 As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =1

                LabelTitleMVP_2 As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: =_lMVP
                    Width: =Parent.Width-20
                    X: =10
                    Y: =5
                    ZIndex: =2

                LabelDetailMVP_2 As label:
                    Height: =Parent.Height-LabelTitleCustomer_2.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lMVPData
                        /**
                        With({_startid:19},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+1).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+1).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+2).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+2).answer
                        )
                        */
                    Width: =172.13333333333333
                    X: =5
                    Y: =60
                    ZIndex: =3

                IconEdit_7 As icon.Edit:
                    Color: =_cBaseColor
                    Height: =20
                    Icon: =Icon.Edit
                    OnSelect: =cmHome_2.moveQuestion(19,false,0);
                    Width: =20
                    X: =147
                    Y: =37
                    ZIndex: =4

                IconExpand_2 As icon.ExpandView:
                    Color: =_cBaseColor
                    Height: =20
                    Icon: =Icon.ExpandView
                    OnSelect: |
                        =Set(
                            _lDialogTitle, _lMVP;
                        );
                        Set(
                            _lDialogData, _lMVPData;
                        );
                        Set(
                            _gIsShowDialog,
                            true
                        );
                    Tooltip: ="ボックスを展開して表示する"
                    Width: =20
                    X: =147
                    Y: =11
                    ZIndex: =5

                IconCheck_6 As icon.CheckBadge:
                    Color: =_cBaseColor
                    DisplayMode: =DisplayMode.View
                    Height: =20
                    Icon: =Icon.CheckBadge
                    Tooltip: ="MVP（ソリューション）"&" 作成済"
                    Visible: |-
                        =With({categoryQuestionCount:CountIf(questionList,category="MVP（ソリューション）"),
                        answerTable:Filter('仮説構築支援ツール - 回答',And(category="MVP（ソリューション）",themeID=themeId))},
                        If(CountIf(answerTable,status=completeStatus)=categoryQuestionCount,true,false))
                    Width: =20
                    X: =120
                    Y: =11
                    ZIndex: =6

            ContainerJTBD_2 As groupContainer.manualLayoutContainer:
                Height: =438
                Width: =Parent.Width/7.5
                X: |-
                    =ContainerCustomer_2.X-
                    ContainerCustomer_2.Width
                Y: =38
                ZIndex: =3

                LabelBoxJTBD_2 As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =4

                LabelTitleJTBD_2 As label:
                    FontWeight: =Semibold
                    Height: =50
                    Size: =16
                    Text: =_lJTBD
                    Width: =111
                    X: =10
                    ZIndex: =5

                LabelDetailJTBD_2 As label:
                    Height: =359
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lJTBDData
                        
                        /**
                        With({_startid:6},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        )
                        */
                    Width: =Parent.Width-20
                    X: =5
                    Y: =60
                    ZIndex: =6

                IconEdit_2 As icon.Edit:
                    Color: =_cBaseColor
                    Height: =20
                    Icon: =Icon.Edit
                    OnSelect: =cmHome_2.moveQuestion(6,false,0);
                    Width: =20
                    X: =147
                    Y: =37
                    ZIndex: =7

                IconExpand_1 As icon.ExpandView:
                    Color: =_cBaseColor
                    Height: =20
                    Icon: =Icon.ExpandView
                    OnSelect: |
                        =Set(
                            _lDialogTitle, _lJTBD;
                        );
                        Set(
                            _lDialogData, _lJTBDData;
                        );
                        Set(
                            _gIsShowDialog,
                            true
                        );
                    Tooltip: ="ボックスを展開して表示する"
                    Width: =20
                    X: =150
                    Y: =10
                    ZIndex: =9

                IconCheck_1 As icon.CheckBadge:
                    Color: =_cBaseColor
                    DisplayMode: =DisplayMode.View
                    Height: =20
                    Icon: =Icon.CheckBadge
                    Tooltip: ="目的（JTBD）"&" 作成済"
                    Visible: |-
                        =With({categoryQuestionCount:CountIf(questionList,category="目的（JTBD）"),
                        answerTable:Filter('仮説構築支援ツール - 回答',And(category="目的（JTBD）",themeID=themeId))},
                        If(CountIf(answerTable,status=completeStatus)=categoryQuestionCount,true,false))
                    Width: =20
                    X: =120
                    Y: =10
                    ZIndex: =10

            ContainerCustomer_2 As groupContainer.manualLayoutContainer:
                Height: =438
                Width: =Parent.Width/7.5
                X: =Parent.Width-ContainerCustomer_2.Width
                Y: =38
                ZIndex: =4

                LabelBoxCustomer_2 As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =7

                LabelTitleCustomer_2 As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: =_lCustomer
                    Width: =121
                    Y: =5
                    ZIndex: =8

                LabelDetailCustomer_2 As label:
                    Height: =359
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lCustomerData
                        
                        /**
                        With({_startid:3},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+1).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+1).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+2).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+2).answer
                        )
                        */
                    Width: =Parent.Width-20
                    X: =5
                    Y: =60
                    ZIndex: =10

                IconEdit As icon.Edit:
                    Color: =_cBaseColor
                    Height: =20
                    Icon: =Icon.Edit
                    OnSelect: =cmHome_2.moveQuestion(3,false,0);
                    Width: =20
                    X: =147
                    Y: =37
                    ZIndex: =11

                IconExpand As icon.ExpandView:
                    Color: =_cBaseColor
                    Height: =20
                    Icon: =Icon.ExpandView
                    OnSelect: |
                        =Set(
                            _lDialogTitle, _lCustomer;
                        );
                        Set(
                            _lDialogData, _lCustomerData;
                        );
                        Set(
                            _gIsShowDialog,
                            true
                        );
                    Tooltip: ="ボックスを展開して表示する"
                    Width: =20
                    X: =147
                    Y: =11
                    ZIndex: =14

                IconCheck As icon.CheckBadge:
                    Color: =_cBaseColor
                    DisplayMode: =DisplayMode.View
                    Height: =20
                    Icon: =Icon.CheckBadge
                    Tooltip: ="顧客"&" 作成済"
                    Visible: |-
                        =With({categoryQuestionCount:CountIf(questionList,category="顧客"),
                        answerTable:Filter('仮説構築支援ツール - 回答',And(category="顧客",themeID=themeId))},
                        If(CountIf(answerTable,status=completeStatus)=categoryQuestionCount,true,false))
                    Width: =20
                    X: =120
                    Y: =11
                    ZIndex: =15

            IconArrow_4 As icon.ChevronLeft:
                Color: =RGBA(0, 13, 75, 1)
                DisplayMode: =DisplayMode.View
                Height: =Parent.Height-10
                Icon: =Icon.ChevronLeft
                Width: =30
                X: =184
                Y: =10
                ZIndex: =5

            GalleryAddCategory_2 As gallery.variableTemplateHeightGallery:
                Height: =464
                Items: =Sort(Filter('仮説構築支援ツール - 追加の問い',themeID=themeId),sort_order)
                Layout: =Layout.Vertical
                TemplateSize: =400
                Width: =Parent.Width-Parent.Width/7.5*3-IconArrow_4.Width
                X: =199
                Y: =10
                ZIndex: =6

                ContainerAddCategory_2 As groupContainer.horizontalAutoLayoutContainer:
                    Height: =298
                    LayoutGap: =5
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =1
                    PaddingTop: =1
                    Width: =Parent.Width-20
                    X: =5
                    ZIndex: =2

                    ContainerVP_2 As groupContainer.manualLayoutContainer:
                        Height: =Parent.Height-10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer_2.Width
                        Width: =LabelBoxCustomer_2.Width
                        ZIndex: =9

                        LabelBoxVP_2 As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Fill: =If(And(_gIsDelete,_gDeleteId=ThisItem.ID),_cBaseColor,RGBA(0, 0, 0, 0))
                            Height: =Parent.Height-50
                            Text: =
                            Width: =LabelBoxCustomer_2.Width
                            X: =1
                            Y: =28
                            ZIndex: =1

                        LabelTitleVP_2 As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lVP&ThisItem.sort_order
                            Width: =Parent.Width
                            Y: =29
                            ZIndex: =2

                        LabelDetailVP_2 As label:
                            Height: =Parent.Height-LabelTitleCustomer_2.Height-80
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colVP,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colVP,Sort(Filter(_cAnswerList,And(themeID=themeId,category="提供価値")),questionID));
                                
                                /**
                                With({_startid:18},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =90
                            ZIndex: =3

                        IconEdit_6 As icon.Edit:
                            Color: =_cBaseColor
                            Height: =20
                            Icon: =Icon.Edit
                            OnSelect: =cmHome_2.moveQuestion(18,true,ThisItem.ID,"提供価値");
                            Width: =20
                            X: =147
                            Y: =57
                            ZIndex: =4

                        IconExpand_6 As icon.ExpandView:
                            Color: =_cBaseColor
                            Height: =20
                            Icon: =Icon.ExpandView
                            OnSelect: |
                                =Set(
                                    _lDialogTitle, _lVP&ThisItem.sort_order;
                                );
                                Set(
                                    _lDialogData, Concat(Filter(colVP,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine);
                                );
                                Set(
                                    _gIsShowDialog,
                                    true
                                );
                            Tooltip: ="ボックスを展開して表示する"
                            Width: =20
                            X: =147
                            Y: =32
                            ZIndex: =5

                        IconCheck_5 As icon.CheckBadge:
                            Color: =_cBaseColor
                            DisplayMode: =DisplayMode.View
                            Height: =20
                            Icon: =Icon.CheckBadge
                            Tooltip: ="提供価値"&" 作成済"
                            Visible: |-
                                =With({categoryQuestionCount:CountIf(questionList,category="提供価値"),
                                answerTable:Filter('仮説構築支援ツール - 回答',And(category="提供価値",themeID=themeId,add_answerID=ThisItem.ID))},
                                If(CountIf(answerTable,status=completeStatus)=categoryQuestionCount,true,false))
                            Width: =20
                            X: =120
                            Y: =32
                            ZIndex: =6

                    IconArrow_5 As icon.ChevronLeft:
                        Color: =RGBA(0, 13, 75, 1)
                        DisplayMode: =DisplayMode.View
                        Height: =Parent.Height-10
                        Icon: =Icon.ChevronLeft
                        Width: =30
                        ZIndex: =13

                    ContainerSatisfaction_2 As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer_2.Width
                        Width: =LabelBoxCustomer_2.Width
                        ZIndex: =14

                        LabelBoxSatisfaction_2 As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Fill: =If(And(_gIsDelete,_gDeleteId=ThisItem.ID),_cBaseColor,RGBA(0, 0, 0, 0))
                            Height: =Parent.Height-50
                            Text: =
                            Width: =LabelBoxCustomer_2.Width
                            X: =1
                            Y: =28
                            ZIndex: =1

                        LabelTitleSatisfaction_2 As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lSatisfaction&ThisItem.sort_order
                            Width: =Parent.Width
                            Y: =29
                            ZIndex: =2

                        LabelDetailSatisfaction_2 As label:
                            Height: =Parent.Height-LabelTitleCustomer_2.Height-80
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colSatisfaction,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colSatisfaction,Sort(Filter(_cAnswerList,And(themeID=themeId,category="満足状況")),questionID));
                                /**
                                With({_startid:14},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+3).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+3,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =90
                            ZIndex: =3

                        IconEdit_5 As icon.Edit:
                            Color: =_cBaseColor
                            Height: =20
                            Icon: =Icon.Edit
                            OnSelect: =cmHome_2.moveQuestion(14,true,ThisItem.ID,"満足状況");
                            Width: =20
                            X: =147
                            Y: =57
                            ZIndex: =4

                        IconExpand_5 As icon.ExpandView:
                            Color: =_cBaseColor
                            Height: =20
                            Icon: =Icon.ExpandView
                            OnSelect: |
                                =Set(
                                    _lDialogTitle, _lSatisfaction&ThisItem.sort_order;
                                );
                                Set(
                                    _lDialogData, Concat(Filter(colSatisfaction,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine);
                                );
                                Set(
                                    _gIsShowDialog,
                                    true
                                );
                            Tooltip: ="ボックスを展開して表示する"
                            Width: =20
                            X: =147
                            Y: =32
                            ZIndex: =5

                        IconCheck_4 As icon.CheckBadge:
                            Color: =_cBaseColor
                            DisplayMode: =DisplayMode.View
                            Height: =20
                            Icon: =Icon.CheckBadge
                            Tooltip: ="満足状況"&" 作成済"
                            Visible: |-
                                =With({categoryQuestionCount:CountIf(questionList,category="満足状況"),
                                answerTable:Filter('仮説構築支援ツール - 回答',And(category="満足状況",themeID=themeId,add_answerID=ThisItem.ID))},
                                If(CountIf(answerTable,status=completeStatus)=categoryQuestionCount,true,false))
                            Width: =20
                            X: =120
                            Y: =32
                            ZIndex: =6

                    ContainerCurrentMeasures_2 As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer_2.Width
                        Width: =LabelBoxCustomer_2.Width
                        ZIndex: =15

                        LabelBoxCurrentMeasures_2 As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Fill: =If(And(_gIsDelete,_gDeleteId=ThisItem.ID),_cBaseColor,RGBA(0, 0, 0, 0))
                            Height: =Parent.Height-50
                            Text: =
                            Width: =LabelBoxCustomer_2.Width
                            X: =1
                            Y: =28
                            ZIndex: =1

                        LabelTitleCurrentMeasures_2 As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lCurrentMeasures&ThisItem.sort_order
                            Width: =Parent.Width
                            Y: =29
                            ZIndex: =2

                        LabelDetailCurrentMeasures_2 As label:
                            Height: =Parent.Height-LabelTitleCustomer_2.Height-80
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colCurrentMeasures,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colCurrentMeasures,Sort(Filter(_cAnswerList,And(themeID=themeId,category="現状対策（代替）")),questionID));
                                
                                
                                /**
                                With({_startid:11},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =90
                            ZIndex: =3

                        IconEdit_4 As icon.Edit:
                            Color: =_cBaseColor
                            Height: =20
                            Icon: =Icon.Edit
                            OnSelect: =cmHome_2.moveQuestion(11,true,ThisItem.ID,"現状対策（代替）");
                            Width: =20
                            X: =147
                            Y: =57
                            ZIndex: =4

                        IconExpand_4 As icon.ExpandView:
                            Color: =_cBaseColor
                            Height: =20
                            Icon: =Icon.ExpandView
                            OnSelect: |
                                =Set(
                                    _lDialogTitle, _lCurrentMeasures&ThisItem.sort_order;
                                );
                                Set(
                                    _lDialogData, Concat(Filter(colCurrentMeasures,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine);
                                );
                                Set(
                                    _gIsShowDialog,
                                    true
                                );
                            Tooltip: ="ボックスを展開して表示する"
                            Width: =20
                            X: =147
                            Y: =32
                            ZIndex: =5

                        IconCheck_3 As icon.CheckBadge:
                            Color: =_cBaseColor
                            DisplayMode: =DisplayMode.View
                            Height: =20
                            Icon: =Icon.CheckBadge
                            Tooltip: ="現状対策（代替）"&" 作成済"
                            Visible: |-
                                =With({categoryQuestionCount:CountIf(questionList,category="現状対策（代替）"),
                                answerTable:Filter('仮説構築支援ツール - 回答',And(category="現状対策（代替）",themeID=themeId,add_answerID=ThisItem.ID))},
                                If(CountIf(answerTable,status=completeStatus)=categoryQuestionCount,true,false))
                            Width: =20
                            X: =120
                            Y: =32
                            ZIndex: =6

                    ContainerHindranceFactor_2 As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer_2.Width
                        Width: =LabelBoxCustomer_2.Width
                        ZIndex: =16

                        LabelBoxHindranceFactor_2 As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Fill: =If(And(_gIsDelete,_gDeleteId=ThisItem.ID),_cBaseColor,RGBA(0, 0, 0, 0))
                            Height: =Parent.Height-50
                            Text: =
                            Width: =LabelBoxCustomer_2.Width
                            X: =1
                            Y: =28
                            ZIndex: =1

                        LabelTitleHindranceFactor_2 As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lHindranceFactor&ThisItem.sort_order
                            Width: =Parent.Width
                            Y: =29
                            ZIndex: =2

                        LabelDetailHindranceFactor_2 As label:
                            Height: =Parent.Height-LabelTitleCustomer_2.Height-80
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colHindranceFactor,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colHindranceFactor,Sort(Filter(_cAnswerList,And(themeID=themeId,category="阻害要因（課題）")),questionID));
                                /**
                                With({_startid:7},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+3).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+3,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =90
                            ZIndex: =3

                        IconEdit_3 As icon.Edit:
                            Color: =_cBaseColor
                            Height: =20
                            Icon: =Icon.Edit
                            OnSelect: =cmHome_2.moveQuestion(7,true,ThisItem.ID,"阻害要因（課題）");
                            Width: =20
                            X: =147
                            Y: =57
                            ZIndex: =4

                        IconExpand_3 As icon.ExpandView:
                            Color: =_cBaseColor
                            Height: =20
                            Icon: =Icon.ExpandView
                            OnSelect: |
                                =Set(
                                    _lDialogTitle, _lHindranceFactor&ThisItem.sort_order;
                                );
                                Set(
                                    _lDialogData, Concat(Filter(colHindranceFactor,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine);
                                );
                                Set(
                                    _gIsShowDialog,
                                    true
                                );
                            Tooltip: ="ボックスを展開して表示する"
                            Width: =20
                            X: =147
                            Y: =32
                            ZIndex: =5

                        IconCheck_2 As icon.CheckBadge:
                            Color: =_cBaseColor
                            DisplayMode: =DisplayMode.View
                            Height: =20
                            Icon: =Icon.CheckBadge
                            Tooltip: ="阻害要因（課題）"&" 作成済"
                            Visible: |-
                                =With({categoryQuestionCount:CountIf(questionList,category="阻害要因（課題）"),
                                answerTable:Filter('仮説構築支援ツール - 回答',And(category="阻害要因（課題）",themeID=themeId,add_answerID=ThisItem.ID))},
                                If(CountIf(answerTable,status=completeStatus)=categoryQuestionCount,true,false))
                            Width: =20
                            X: =120
                            Y: =32
                            ZIndex: =6

                IconDelete_2 As icon.CancelBadge:
                    Color: =_cBaseColor
                    DisabledColor: =_cBaseColor
                    Height: =25
                    Icon: =Icon.CancelBadge
                    OnSelect: |-
                        =Set(_gDeleteId,ThisItem.ID);
                        Set(_gIsDelete,true);
                        Set(_gDeleteSortOrder,ThisItem.sort_order);
                    Tooltip: ="追加した回答行を削除"
                    Visible: =If(CountRows(Filter('仮説構築支援ツール - 追加の問い',themeID=themeId).ID)=1, false, true)
                    Width: =25
                    X: =10.600000000000023
                    ZIndex: =3

                ButtonAddQuestion_2 As button:
                    BorderThickness: =1
                    Color: =_cBaseColor
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =ColorFade(_cBaseColor, 20%)
                    Fill: =RGBA(245,245,245,1)
                    FocusedBorderColor: =ColorFade(_cBaseColor, 20%)
                    FocusedBorderThickness: =1
                    FontWeight: =Normal
                    Height: =70
                    HoverBorderColor: =ColorFade(_cBaseColor, 20%)
                    HoverFill: =ColorFade(_cBaseColor, 20%)
                    OnSelect: |-
                        =Collect('仮説構築支援ツール - 追加の問い',{themeID:themeId,sort_order:_gMaxSortNumber+1});
                        Set(_gMaxSortNumber,_gMaxSortNumber+1);
                    PaddingBottom: =10
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =ColorFade(_cBaseColor, 20%)
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =24
                    Text: ="＋追加"
                    Visible: =If(And(_gMaxSortNumber=ThisItem.sort_order,_gMaxSortNumber<5),true)
                    Width: =760
                    X: =5
                    Y: =290
                    ZIndex: =4

                IconDown_2 As icon.Hamburger:
                    Color: =_cBaseColor
                    DisabledColor: =_cBaseColor
                    Height: =25
                    Icon: =Icon.BackArrow
                    OnSelect: |-
                        =UpdateIf('仮説構築支援ツール - 追加の問い',And(themeID=themeId,sort_order=ThisItem.sort_order+1),{sort_order:ThisItem.sort_order},ID=ThisItem.ID,{sort_order:ThisItem.sort_order+1});
                        //UpdateIf('仮説構築支援ツール - 追加の問い',ID=ThisItem.ID,{sort_order:ThisItem.sort_order+1});
                    Rotation: =-90
                    Tooltip: ="回答行を下に移動"
                    Visible: =If(ThisItem.sort_order=First(Sort(Filter('仮説構築支援ツール - 追加の問い',themeID=themeId),sort_order,Descending)).sort_order, false, true)
                    Width: =25
                    X: =735
                    ZIndex: =5

                IconUp_2 As icon.Hamburger:
                    Color: =_cBaseColor
                    DisabledColor: =_cBaseColor
                    Height: =25
                    Icon: =Icon.NextArrow
                    OnSelect: |-
                        =UpdateIf('仮説構築支援ツール - 追加の問い', And(themeID=themeId,sort_order=ThisItem.sort_order-1), {sort_order:ThisItem.sort_order},ID=ThisItem.ID,{sort_order:ThisItem.sort_order-1});
                        //UpdateIf('仮説構築支援ツール - 追加の問い',ID=ThisItem.ID,{sort_order:ThisItem.sort_order-1});
                    Rotation: =-90
                    Tooltip: ="回答行を上に移動"
                    Visible: =If(ThisItem.sort_order=1, false, true)
                    Width: =25
                    X: =690
                    ZIndex: =6

        ContainerHeader_2 As groupContainer.manualLayoutContainer:
            Height: =40
            Width: =Max(App.Width, App.MinScreenWidth)
            Y: =40
            ZIndex: =10

            LabelValueProposition As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(23, 143, 152, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                Size: =12
                Text: ="VP：Value Proposition（提供価値）"
                Width: =Parent.Width*28%
                X: =5
                ZIndex: =2

            LabelCustomerSegment As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(0, 134, 200, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                Size: =12
                Text: ="CS：Customer Segment（提供価値）"
                Width: =Parent.Width*68%
                X: =423
                ZIndex: =3

        Button1_1 As button:
            BorderThickness: =0
            DisabledFill: =ColorFade(_cBaseColor,-20%)
            Fill: =_cBaseColor
            FocusedBorderThickness: =0
            Height: =25
            HoverFill: =ColorFade(_cBaseColor,-20%)
            OnSelect: =cmHome_2.moveQuestion(1,false,0);
            Size: =12
            Text: ="前提条件を設定"
            Width: =222
            X: =10
            Y: =5
            ZIndex: =11

        GroupDeleteConfirm_2 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =-287
            ZIndex: =58

            Rectangle1_4 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0.2)
                Height: =640
                Visible: =If(_gIsDelete,true,false)
                Width: =Max(App.Width, App.MinScreenWidth)
                ZIndex: =4

            RectangleDialog_2 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderThickness: =
                Fill: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =0
                Height: =270
                Visible: =If(_gIsDelete,true,false)
                Width: =500
                X: =(App.Width/2)-(Self.Width/2)
                Y: =Rectangle1_4.Height/3
                ZIndex: =5

            LabelConfirmMessage_2 As label:
                Align: =Left
                Color: =RGBA(116, 116, 116, 1)
                FontWeight: =Normal
                Height: =103
                Size: =12
                Text: |-
                    ="色が付いた行を削除します。
                    この行を削除すると登録した回答も削除されます。
                    この操作を元に戻すことはできません。
                    続行しますか？"
                Visible: =If(_gIsDelete,true,false)
                Width: =470
                X: =443
                Y: =296
                ZIndex: =6

            ButtonDelete_2 As button:
                BorderThickness: =0
                Fill: =RGBA(203, 102, 102, 1)
                FocusedBorderThickness: =0
                Height: =35
                HoverFill: =ColorFade(Self.Fill,-20%)
                OnSelect: |-
                    =With({answerRecord:Filter('仮説構築支援ツール - 回答',add_answerID=_gDeleteId)},
                    If(
                        Not(IsBlank(answerRecord)),
                        Remove('仮説構築支援ツール - 回答',answerRecord);
                    );
                    );
                    Remove('仮説構築支援ツール - 追加の問い',LookUp('仮説構築支援ツール - 追加の問い',ID=_gDeleteId));
                    UpdateIf('仮説構築支援ツール - 追加の問い',And(themeID=themeId,sort_order>_gDeleteSortOrder),{sort_order:sort_order-1});
                    Set(_gIsDelete,false);
                    Set(_gMaxSortNumber,_gMaxSortNumber-1);
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =14
                Text: ="削除"
                Visible: =If(_gIsDelete,true,false)
                Width: =100
                X: =692
                Y: =430
                ZIndex: =7

            ButtonCancel_2 As button:
                BorderThickness: =1
                Color: =RGBA(0, 0, 0, 1)
                Fill: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =1
                Height: =35
                HoverColor: =RGBA(0, 0, 0, 1)
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: =Set(_gIsDelete,false)
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =12
                Text: ="キャンセル"
                Visible: =If(_gIsDelete,true,false)
                Width: =100
                X: =817
                Y: =430
                ZIndex: =8

            LabelDeleteTitle_2 As label:
                Align: =Left
                Color: =RGBA(0, 13, 75, 1)
                FontWeight: =FontWeight.Semibold
                Height: =70
                Size: =20
                Text: |-
                    ="行を削除しますか？
                    "
                Visible: =If(_gIsDelete,true,false)
                Width: =425
                X: =443
                Y: =230
                ZIndex: =9

