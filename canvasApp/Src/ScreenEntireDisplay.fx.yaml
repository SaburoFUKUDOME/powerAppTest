ScreenEntireDisplay As screen:
    OnVisible: |-
        =UpdateContext({_lNewLine:Char(10),_lIcon:"■"});

    ContainerHeader As groupContainer.manualLayoutContainer:
        Height: =80
        Width: =Max(App.Width, App.MinScreenWidth)
        ZIndex: =1

        Image As image:
            Height: =Parent.Height
            Image: =header
            Width: =Parent.Width
            ZIndex: =1

    ContainerMain As groupContainer.manualLayoutContainer:
        Height: =688
        Width: =Max(App.Width, App.MinScreenWidth)
        Y: =ContainerHeader.Height
        ZIndex: =2

        ContainerFooter3 As groupContainer.manualLayoutContainer:
            Height: =50
            Width: =Parent.Width
            Y: =ContainerCanvas.Height
            ZIndex: =50

            IconBackThemeScreen_2 As icon.BackArrow:
                Color: =_cBaseColor
                Height: =30
                Icon: =Icon.BackArrow
                OnSelect: =Navigate(screenCanvas,Fade)
                Tooltip: ="Home画面へ戻る"
                Width: =30
                X: =19
                Y: =10
                ZIndex: =2

            ButtonOutput As button:
                BorderColor: =_cBaseColor
                BorderThickness: =0
                Fill: =_cBaseColor
                FocusedBorderColor: =ColorFade(_cBaseColor,-20%)
                Height: =30
                HoverBorderColor: =ColorFade(_cBaseColor,-20%)
                HoverFill: =ColorFade(_cBaseColor,-20%)
                OnSelect: |
                    =//Set(ExportData, Concat(ExportCol, category & "," & answer & Char(13)));
                    Set(ExportData, "test");
                    Set(_k,Sort(Filter(answerList,And(themeID=themeId,category="顧客")),questionID));
                    Set(_j,Sort(Filter(answerList,And(themeID=themeId,category="目的（JTBD）")),questionID));
                    Set(_s,Sort(Filter(answerList,And(themeID=themeId,category="阻害要因（課題）")),questionID));
                    Set(_g,Sort(Filter(answerList,And(themeID=themeId,category="現状対策（代替）")),questionID));
                    Set(_m,Sort(Filter(answerList,And(themeID=themeId,category="満足状況")),questionID));
                    Set(_t,Sort(Filter(answerList,And(themeID=themeId,category="提供価値")),questionID));
                    Set(_mv,Sort(Filter(answerList,And(themeID=themeId,category="MVP（ソリューション）")),questionID));
                    
                    ClearCollect(ExportCol1,_k);
                    ClearCollect(ExportCol2,_j);
                    ClearCollect(ExportCol3,_s);
                    ClearCollect(ExportCol4,_g);
                    ClearCollect(ExportCol5,_m);
                    ClearCollect(ExportCol6,_t);
                    ClearCollect(ExportCol7,_mv);
                    
                    
                    Set(ExportData1, "【背景・属性】"&Char(13)&Concat(ExportCol1,_lIcon&LookUp(questionList,ID=questionID).Title&Char(13)&answer&Char(13)&Char(13))&
                     "【JTBD】"&Char(13)&Concat(ExportCol2,_lIcon&LookUp(questionList,ID=questionID).Title&Char(13)&answer&Char(13)&Char(13))&
                     "【阻害要因】"&Char(13)&Concat(ExportCol3,_lIcon&LookUp(questionList,ID=questionID).Title&Char(13)&answer&Char(13)&Char(13))&
                    "【現状対策】"&Char(13)&Concat(ExportCol4,_lIcon&LookUp(questionList,ID=questionID).Title&Char(13)&answer&Char(13)&Char(13))&
                    "【満足状況】"&Char(13)&Concat(ExportCol5,_lIcon&LookUp(questionList,ID=questionID).Title&Char(13)&answer&Char(13)&Char(13))&
                    "【VP】"&Char(13)&Concat(ExportCol6,_lIcon&LookUp(questionList,ID=questionID).Title&Char(13)&answer&Char(13)&Char(13))&
                    "【MVP】"&Char(13)&Concat(ExportCol7,_lIcon&LookUp(questionList,ID=questionID).Title&Char(13)&answer&Char(13)&Char(13)));
                    
                    UpdateContext({result: ExportCSV.Run("仮説構築支援_"& Now(),ExportData1)});
                    Notify("OneDriveにファイルを出力しました。ファイルパス：["&result.filepath&"]", NotificationType.Information)
                PressedBorderColor: =ColorFade(_cBaseColor,-20%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(_cBaseColor,-20%)
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Text: ="出力"
                Width: =200
                X: =1148
                Y: =10
                ZIndex: =3

        ContainerCanvas As groupContainer.manualLayoutContainer:
            Height: =Parent.Height-ContainerFooter3.Height
            Width: =Parent.Width
            ZIndex: =51

            ContainerMVP As groupContainer.manualLayoutContainer:
                Height: =Parent.Height
                Width: =Parent.Width/7.5
                X: =5
                ZIndex: =1

                LabelBoxMVP As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =1

                LabelTitleMVP As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: ="MVP"
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =2

                LabelDetailMVP As label:
                    Height: =Parent.Height-LabelTitleCustomer.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =
                        With({_startid:19},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+1).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+1).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+2).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+2).answer
                        )
                    Width: =Parent.Width-20
                    X: =10
                    Y: =50
                    ZIndex: =3

            GalleryAddCategory As gallery.galleryVertical:
                Height: =Parent.Height
                Items: =Sort(Filter('仮説構築支援ツール - 追加の問い',themeID=themeId),sort_order)
                Layout: =Layout.Vertical
                TemplatePadding: =1
                TemplateSize: =Parent.Height/2.2
                Width: =Parent.Width-Parent.Width/7.5*3-IconArrow_1.Width
                X: =ContainerMVP.Width+IconArrow_1.Width
                ZIndex: =2

                ContainerAddCategory As groupContainer.horizontalAutoLayoutContainer:
                    Height: =Parent.TemplateHeight
                    LayoutGap: =5
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =1
                    PaddingTop: =1
                    Width: =Parent.Width-20
                    X: =5
                    ZIndex: =6

                    ContainerVP As groupContainer.manualLayoutContainer:
                        Height: =Parent.Height-10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer.Width
                        Width: =LabelBoxCustomer.Width
                        ZIndex: =9

                        LabelBoxVP As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Height: =Parent.Height-10
                            Text: =
                            Width: =LabelBoxCustomer.Width
                            X: =1
                            Y: =9
                            ZIndex: =1

                        LabelTitleVP As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: ="VP"&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =9
                            ZIndex: =2

                        LabelDetailVP As label:
                            Height: =Parent.Height-LabelTitleCustomer.Height-20
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =
                                With({_startid:18},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                )
                            Width: =Parent.Width-20
                            X: =10
                            Y: =50
                            ZIndex: =3

                    IconArrow As icon.ChevronLeft:
                        Color: =RGBA(0, 13, 75, 1)
                        Height: =Parent.Height-10
                        Icon: =Icon.ChevronLeft
                        Width: =30
                        ZIndex: =13

                    ContainerSatisfaction As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer.Width
                        Width: =LabelBoxCustomer.Width
                        ZIndex: =14

                        LabelBoxSatisfaction As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Height: =Parent.Height-10
                            Text: =
                            Width: =LabelBoxCustomer.Width
                            X: =1
                            Y: =9
                            ZIndex: =1

                        LabelTitleSatisfaction As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: ="満足状況"&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =9
                            ZIndex: =2

                        LabelDetailSatisfaction As label:
                            Height: =Parent.Height-LabelTitleCustomer.Height-20
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =
                                With({_startid:14},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+3).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+3,add_answerID=ThisItem.ID)).answer
                                )
                            Width: =Parent.Width-20
                            X: =10
                            Y: =50
                            ZIndex: =3

                    ContainerCurrentMeasures As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer.Width
                        Width: =LabelBoxCustomer.Width
                        ZIndex: =15

                        LabelBoxCurrentMeasures As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Height: =Parent.Height-10
                            Text: =
                            Width: =LabelBoxCustomer.Width
                            X: =1
                            Y: =9
                            ZIndex: =1

                        LabelTitleCurrentMeasures As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: ="現状対策"&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =9
                            ZIndex: =2

                        LabelDetailCurrentMeasures As label:
                            Height: =Parent.Height-LabelTitleCustomer.Height-20
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =
                                With({_startid:11},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                )
                            Width: =Parent.Width-20
                            X: =10
                            Y: =50
                            ZIndex: =3

                    ContainerHindranceFactor As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer.Width
                        Width: =LabelBoxCustomer.Width
                        ZIndex: =16

                        LabelBoxHindranceFactor As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Height: =Parent.Height-10
                            Text: =
                            Width: =LabelBoxCustomer.Width
                            X: =1
                            Y: =9
                            ZIndex: =1

                        LabelTitleHindranceFactor As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: ="阻害要因"&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =9
                            ZIndex: =2

                        LabelDetailHindranceFactor As label:
                            Height: =Parent.Height-LabelTitleCustomer.Height-20
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =
                                With({_startid:7},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+3).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+3,add_answerID=ThisItem.ID)).answer
                                )
                            Width: =Parent.Width-20
                            X: =10
                            Y: =50
                            ZIndex: =3

            ContainerJTBD As groupContainer.manualLayoutContainer:
                Height: =Parent.Height-10
                Width: =Parent.Width/7.5
                X: |-
                    =ContainerCustomer.X-
                    ContainerCustomer.Width
                ZIndex: =3

                LabelBoxJTBD As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =4

                LabelTitleJTBD As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: ="JTBD"
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =5

                LabelDetailJTBD As label:
                    Height: =Parent.Height-LabelTitleCustomer.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =
                        With({_startid:6},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        )
                    Width: =Parent.Width-20
                    X: =10
                    Y: =50
                    ZIndex: =6

            ContainerCustomer As groupContainer.manualLayoutContainer:
                Height: =Parent.Height-10
                Width: =Parent.Width/7.5
                X: =Parent.Width-ContainerCustomer.Width
                ZIndex: =4

                LabelBoxCustomer As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =7

                LabelTitleCustomer As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: ="属性・背景"
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =8

                LabelDetailCustomer As label:
                    Height: =Parent.Height-LabelTitleCustomer.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =
                        With({_startid:3},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+1).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+1).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+2).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+2).answer
                        )
                    Width: =Parent.Width-20
                    X: =10
                    Y: =50
                    ZIndex: =10

            IconArrow_1 As icon.ChevronLeft:
                Color: =RGBA(0, 13, 75, 1)
                Height: =Parent.Height-10
                Icon: =Icon.ChevronLeft
                Width: =30
                X: =184
                Y: =10
                ZIndex: =5

