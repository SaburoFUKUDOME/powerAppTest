ScreenEntireDisplay As screen:
    OnVisible: |+
        =UpdateContext({
        _lNewLine:Char(10),
        _lIcon:"■",
        _lCustomer:"属性・背景",_lJTBD:"JTBD",_lHindranceFactor:"阻害要因",_lCurrentMeasures:"現状対策",_lSatisfaction:"満足状況",_lVP:"VP",_lMVP:"MVP"// キャンバスのタイトル
        });
        
        // コレクションを作成
        ClearCollect(colCustomer,Sort(Filter(_cAnswerList,And(themeID=themeId,category="顧客")),questionID));
        ClearCollect(colJTBD,Sort(Filter(_cAnswerList,And(themeID=themeId,category="目的（JTBD）")),questionID));
        ClearCollect(colHindranceFactor,Sort(Filter(_cAnswerList,And(themeID=themeId,category="阻害要因（課題）")),questionID));
        ClearCollect(colCurrentMeasures,Sort(Filter(_cAnswerList,And(themeID=themeId,category="現状対策（代替）")),questionID));
        ClearCollect(colSatisfaction,Sort(Filter(_cAnswerList,And(themeID=themeId,category="満足状況")),questionID));
        ClearCollect(colVP,Sort(Filter(_cAnswerList,And(themeID=themeId,category="提供価値")),questionID));
        ClearCollect(colMVP,Sort(Filter(_cAnswerList,And(themeID=themeId,category="MVP（ソリューション）")),questionID));
        
        // キャンバスのボックス内に表示する文字を作成(追加できるカテゴリは、ギャラリー内の各ラベルで作成する)
        UpdateContext({
        _lCustomerData:Concat(colCustomer,_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine),// 属性・背景
        _lJTBDData:Concat(colJTBD,_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine),// JTBD
        _lMVPData:Concat(colMVP,_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)// MVP
        });
        

    ContainerHeader As groupContainer.manualLayoutContainer:
        Height: =80
        Width: =Max(App.Width, App.MinScreenWidth)
        ZIndex: =1

        Image As image:
            Height: =Parent.Height
            Image: =header
            Width: =Parent.Width
            ZIndex: =1

    ContainerMain As groupContainer.manualLayoutContainer:
        Height: =688
        Width: =Max(App.Width, App.MinScreenWidth)
        Y: =ContainerHeader.Height
        ZIndex: =2

        ContainerFooter3 As groupContainer.manualLayoutContainer:
            Height: =50
            Width: =Parent.Width
            Y: =ContainerCanvas.Height
            ZIndex: =50

            IconBackThemeScreen_2 As icon.BackArrow:
                Color: =_cBaseColor
                Height: =30
                Icon: =Icon.BackArrow
                OnSelect: =Navigate(screenCanvas,Fade)
                Tooltip: ="Home画面へ戻る"
                Width: =30
                X: =20
                Y: =10
                ZIndex: =2

            ButtonOutput As button:
                BorderColor: =_cBaseColor
                BorderThickness: =0
                DisplayMode: =DisplayMode.Disabled
                Fill: =_cBaseColor
                FocusedBorderColor: =ColorFade(_cBaseColor,-20%)
                Height: =30
                HoverBorderColor: =ColorFade(_cBaseColor,-20%)
                HoverFill: =ColorFade(_cBaseColor,-20%)
                OnSelect: |
                    =
                    
                    // 阻害要因
                    Clear(colOutputTextHindranceFactor);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextHindranceFactor, {addId:_addId,text:"【"&_lHindranceFactor&Value&"】"&_lNewLine&Concat(Filter(colHindranceFactor,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 現状対策
                    Clear(colOutputTextCurrentMeasures);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextCurrentMeasures, {addId:_addId,text:"【"&_lCurrentMeasures&Value&"】"&_lNewLine&Concat(Filter(colCurrentMeasures,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 満足状況
                    Clear(colOutputTextSatisfaction);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextSatisfaction, {addId:_addId,text:"【"&_lSatisfaction&Value&"】"&_lNewLine&Concat(Filter(colSatisfaction,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // VP
                    Clear(colOutputTextVP);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextVP, {addId:_addId,text:"【"&_lVP&Value&"】"&_lNewLine&Concat(Filter(colVP,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 出力文字を連結する
                    Set(ExportData,
                    "【"&_lCustomer&"】"&_lNewLine&_lCustomerData&_lNewLine&
                    "【"&_lJTBD&"】"&_lNewLine&_lJTBDData&_lNewLine&
                    Concat(colOutputTextHindranceFactor,text&_lNewLine)&
                    Concat(colOutputTextCurrentMeasures,text&_lNewLine)&
                    Concat(colOutputTextSatisfaction,text&_lNewLine)&
                    Concat(colOutputTextVP,text&_lNewLine)&
                    "【"&_lMVP&"】"&_lNewLine&_lMVPData);
                    
                    //UpdateContext({result: ExportCSV.Run("HypothesisCreator_"& Text(Now(), "yyyymmddhhmm"),ExportData)});
                    UpdateContext({result: csvDL.Run("HypothesisCreator_"& Text(Now(), "yyyymmddhhmm"),ExportData)});
                    Notify("ファイルをダウンロードしました。", NotificationType.Information);
                    Download("https://rfgricoh.sharepoint.com/teams/ZJS_GP_JRITS_BSJ_EIMDC_APL/HYPOBUIL"&result.path)
                PressedBorderColor: =ColorFade(_cBaseColor,-20%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(_cBaseColor,-20%)
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Text: ="出力"
                Width: =200
                X: =1148
                Y: =10
                ZIndex: =3

            Label3 As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =20
                LineHeight: =1.0
                Size: =11
                Text: ="©New*New All rights reserved."
                Width: =337
                X: =515
                Y: =20
                ZIndex: =4

            Button1 As button:
                OnSelect: |-
                    =// 阻害要因
                    Clear(colOutputTextHindranceFactor);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextHindranceFactor, {addId:_addId,text:Concat(Filter(colHindranceFactor,add_answerID=_addId),"【"&_lHindranceFactor&Value&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&answer&""""&_lNewLine)
                    }))
                    );
                    
                    // 現状対策
                    Clear(colOutputTextCurrentMeasures);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextCurrentMeasures, {addId:_addId,text:Concat(Filter(colCurrentMeasures,add_answerID=_addId),"【"&_lCurrentMeasures&Value&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&answer&""""&_lNewLine)
                    }))
                    );
                    
                    // 満足状況
                    Clear(colOutputTextSatisfaction);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextSatisfaction, {addId:_addId,text:Concat(Filter(colSatisfaction,add_answerID=_addId),"【"&_lSatisfaction&Value&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&answer&""""&_lNewLine)
                    }))
                    );
                    
                    // VP
                    Clear(colOutputTextVP);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextVP, {addId:_addId,text:Concat(Filter(colVP,add_answerID=_addId),"【"&_lVP&Value&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&answer&""""&_lNewLine)
                    }))
                    );
                    
                    
                    Set(ExportData2,
                    Concat(colCustomer,"【"&_lCustomer&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&answer&""""&_lNewLine)&
                    Concat(colJTBD,"【"&_lJTBD&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&answer&""""&_lNewLine)&
                    Concat(colOutputTextHindranceFactor,text)&
                    Concat(colOutputTextCurrentMeasures,text)&
                    Concat(colOutputTextSatisfaction,text)&
                    Concat(colOutputTextVP,text)&
                    Concat(colMVP,"【"&_lMVP&"】,"&_lIcon&LookUp(questionList,ID=questionID).Title&","""&answer&""""&_lNewLine));
                    
                    
                    UpdateContext({result: csvDL.Run("HypothesisCreator_csv_"& Text(Now(), "yyyymmddhhmm"),ExportData2)});
                    Download("https://rfgricoh.sharepoint.com/teams/ZJS_GP_JRITS_BSJ_EIMDC_APL/HYPOBUIL"&result.path);
                    Notify("ファイルをダウンロードしました。", NotificationType.Information);
                Size: =12
                Text: ="3.CSV形式でDL"
                Width: =120
                X: =748
                Y: =5
                ZIndex: =5

            Button2_1 As button:
                OnSelect: |
                    =// 阻害要因
                    Clear(colOutputTextHindranceFactor);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextHindranceFactor, {addId:_addId,text:"【"&_lHindranceFactor&Value&"】"&_lNewLine&Concat(Filter(colHindranceFactor,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 現状対策
                    Clear(colOutputTextCurrentMeasures);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextCurrentMeasures, {addId:_addId,text:"【"&_lCurrentMeasures&Value&"】"&_lNewLine&Concat(Filter(colCurrentMeasures,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 満足状況
                    Clear(colOutputTextSatisfaction);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextSatisfaction, {addId:_addId,text:"【"&_lSatisfaction&Value&"】"&_lNewLine&Concat(Filter(colSatisfaction,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // VP
                    Clear(colOutputTextVP);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextVP, {addId:_addId,text:"【"&_lVP&Value&"】"&_lNewLine&Concat(Filter(colVP,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 出力文字を連結する
                    Set(ExportData,
                    "【"&_lCustomer&"】"&_lNewLine&_lCustomerData&_lNewLine&
                    "【"&_lJTBD&"】"&_lNewLine&_lJTBDData&_lNewLine&
                    Concat(colOutputTextHindranceFactor,text&_lNewLine)&
                    Concat(colOutputTextCurrentMeasures,text&_lNewLine)&
                    Concat(colOutputTextSatisfaction,text&_lNewLine)&
                    Concat(colOutputTextVP,text&_lNewLine)&
                    "【"&_lMVP&"】"&_lNewLine&_lMVPData);
                    
                    //UpdateContext({result: ExportCSV.Run("HypothesisCreator_"& Text(Now(), "yyyymmddhhmm"),ExportData)});
                    UpdateContext({result: ExportTxtOneDrive.Run("/HypothesisCreator","HypothesisCreator_"& Text(Now(), "yyyymmddhhmm"),ExportData)});
                    Notify("OneDriveにダウンロードしました。["&result.path&"]", NotificationType.Information);
                Size: =10
                Text: ="２.テキスト形式でOneDriveに保存"
                Width: =123
                X: =392
                Y: =5
                ZIndex: =7

            Button2_2 As button:
                OnSelect: |
                    =// 阻害要因
                    Clear(colOutputTextHindranceFactor);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextHindranceFactor, {addId:_addId,text:"【"&_lHindranceFactor&Value&"】"&_lNewLine&Concat(Filter(colHindranceFactor,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 現状対策
                    Clear(colOutputTextCurrentMeasures);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextCurrentMeasures, {addId:_addId,text:"【"&_lCurrentMeasures&Value&"】"&_lNewLine&Concat(Filter(colCurrentMeasures,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 満足状況
                    Clear(colOutputTextSatisfaction);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextSatisfaction, {addId:_addId,text:"【"&_lSatisfaction&Value&"】"&_lNewLine&Concat(Filter(colSatisfaction,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // VP
                    Clear(colOutputTextVP);
                    ForAll(Sequence(CountRows(GalleryAddCategory.AllItems)),
                    With({_addId:Index(GalleryAddCategory.AllItems,Value).ID},
                    Collect(colOutputTextVP, {addId:_addId,text:"【"&_lVP&Value&"】"&_lNewLine&Concat(Filter(colVP,add_answerID=_addId),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                    }))
                    );
                    
                    // 出力文字を連結する
                    Set(ExportData3,
                    "【"&_lCustomer&"】"&_lNewLine&_lCustomerData&_lNewLine&
                    "【"&_lJTBD&"】"&_lNewLine&_lJTBDData&_lNewLine&
                    Concat(colOutputTextHindranceFactor,text&_lNewLine)&
                    Concat(colOutputTextCurrentMeasures,text&_lNewLine)&
                    Concat(colOutputTextSatisfaction,text&_lNewLine)&
                    Concat(colOutputTextVP,text&_lNewLine)&
                    "【"&_lMVP&"】"&_lNewLine&_lMVPData);
                    
                    //UpdateContext({result: ExportCSV.Run("HypothesisCreator_"& Text(Now(), "yyyymmddhhmm"),ExportData)});
                    UpdateContext({result: txtDL.Run("HypothesisCreator_txt_"& Text(Now(), "yyyymmddhhmm"),ExportData3)});
                    Download("https://rfgricoh.sharepoint.com/teams/ZJS_GP_JRITS_BSJ_EIMDC_APL/HYPOBUIL"&result.path);
                    Notify("ファイルをダウンロードしました。", NotificationType.Information);
                Size: =10
                Text: ="1.テキスト形式でDL(拡張子csv)"
                Width: =120
                X: =223
                Y: =7
                ZIndex: =8

            Label1 As label:
                Align: =Right
                Fill: =RGBA(255, 255, 255, 1)
                Height: =45
                Size: =8
                Text: ="形式はテキストですが、ファイルの拡張子はcsvになります→"
                Width: =131
                X: =92
                Y: =5
                ZIndex: =9

        ContainerCanvas As groupContainer.manualLayoutContainer:
            Height: =Parent.Height-ContainerFooter3.Height
            Width: =Parent.Width
            ZIndex: =51

            ContainerMVP As groupContainer.manualLayoutContainer:
                Height: =Parent.Height
                Width: =Parent.Width/7.5
                X: =5
                ZIndex: =1

                LabelBoxMVP As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =1

                LabelTitleMVP As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: =_lMVP
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =2

                LabelDetailMVP As label:
                    Height: =Parent.Height-LabelTitleCustomer.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lMVPData
                        /**
                        With({_startid:19},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+1).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+1).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+2).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+2).answer
                        )
                        */
                    Width: =172.13333333333333
                    X: =10
                    Y: =50
                    ZIndex: =3

            GalleryAddCategory As gallery.galleryVertical:
                Height: =Parent.Height
                Items: =Sort(Filter('仮説構築支援ツール - 追加の問い',themeID=themeId),sort_order)
                Layout: =Layout.Vertical
                TemplatePadding: =1
                TemplateSize: =Parent.Height/2.2
                Width: =Parent.Width-Parent.Width/7.5*3-IconArrow_1.Width
                X: =ContainerMVP.Width+IconArrow_1.Width
                ZIndex: =2

                ContainerAddCategory As groupContainer.horizontalAutoLayoutContainer:
                    Height: =Parent.TemplateHeight
                    LayoutGap: =5
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =1
                    PaddingTop: =1
                    Width: =Parent.Width-20
                    X: =5
                    ZIndex: =6

                    ContainerVP As groupContainer.manualLayoutContainer:
                        Height: =Parent.Height-10
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer.Width
                        Width: =LabelBoxCustomer.Width
                        ZIndex: =9

                        LabelBoxVP As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Height: =Parent.Height-10
                            Text: =
                            Width: =LabelBoxCustomer.Width
                            X: =1
                            Y: =9
                            ZIndex: =1

                        LabelTitleVP As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lVP&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =9
                            ZIndex: =2

                        LabelDetailVP As label:
                            Height: =Parent.Height-LabelTitleCustomer.Height-20
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colVP,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colVP,Sort(Filter(_cAnswerList,And(themeID=themeId,category="提供価値")),questionID));
                                
                                /**
                                With({_startid:18},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =50
                            ZIndex: =3

                    IconArrow As icon.ChevronLeft:
                        Color: =RGBA(0, 13, 75, 1)
                        DisplayMode: =DisplayMode.View
                        Height: =Parent.Height-10
                        Icon: =Icon.ChevronLeft
                        Width: =30
                        ZIndex: =13

                    ContainerSatisfaction As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer.Width
                        Width: =LabelBoxCustomer.Width
                        ZIndex: =14

                        LabelBoxSatisfaction As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Height: =Parent.Height-10
                            Text: =
                            Width: =LabelBoxCustomer.Width
                            X: =1
                            Y: =9
                            ZIndex: =1

                        LabelTitleSatisfaction As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lSatisfaction&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =9
                            ZIndex: =2

                        LabelDetailSatisfaction As label:
                            Height: =Parent.Height-LabelTitleCustomer.Height-20
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colSatisfaction,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colSatisfaction,Sort(Filter(_cAnswerList,And(themeID=themeId,category="満足状況")),questionID));
                                /**
                                With({_startid:14},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+3).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+3,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =50
                            ZIndex: =3

                    ContainerCurrentMeasures As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer.Width
                        Width: =LabelBoxCustomer.Width
                        ZIndex: =15

                        LabelBoxCurrentMeasures As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Height: =Parent.Height-10
                            Text: =
                            Width: =LabelBoxCustomer.Width
                            X: =1
                            Y: =9
                            ZIndex: =1

                        LabelTitleCurrentMeasures As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lCurrentMeasures&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =9
                            ZIndex: =2

                        LabelDetailCurrentMeasures As label:
                            Height: =Parent.Height-LabelTitleCustomer.Height-20
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colCurrentMeasures,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colCurrentMeasures,Sort(Filter(_cAnswerList,And(themeID=themeId,category="現状対策（代替）")),questionID));
                                
                                
                                /**
                                With({_startid:11},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =50
                            ZIndex: =3

                    ContainerHindranceFactor As groupContainer.manualLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =LabelBoxCustomer.Width
                        Width: =LabelBoxCustomer.Width
                        ZIndex: =16

                        LabelBoxHindranceFactor As label:
                            BorderColor: =RGBA(0, 13, 75, 1)
                            BorderThickness: =2
                            Height: =Parent.Height-10
                            Text: =
                            Width: =LabelBoxCustomer.Width
                            X: =1
                            Y: =9
                            ZIndex: =1

                        LabelTitleHindranceFactor As label:
                            FontWeight: =Semibold
                            Height: =44
                            Size: =16
                            Text: =_lHindranceFactor&ThisItem.sort_order
                            Width: =Parent.Width
                            X: =1
                            Y: =9
                            ZIndex: =2

                        LabelDetailHindranceFactor As label:
                            Height: =Parent.Height-LabelTitleCustomer.Height-20
                            Overflow: =Overflow.Scroll
                            Size: =11
                            Text: |-
                                =Concat(Filter(colHindranceFactor,add_answerID=ThisItem.ID),_lIcon&LookUp(questionList,ID=questionID).Title&_lNewLine&answer&_lNewLine&_lNewLine)
                                
                                //ClearCollect(colHindranceFactor,Sort(Filter(_cAnswerList,And(themeID=themeId,category="阻害要因（課題）")),questionID));
                                /**
                                With({_startid:7},
                                _lIcon&LookUp(questionList,ID=_startid).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+1).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+1,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+2).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+2,add_answerID=ThisItem.ID)).answer
                                &_lNewLine&_lNewLine&
                                _lIcon&LookUp(questionList,ID=_startid+3).Title
                                &_lNewLine&
                                LookUp(_gAnswerList,And(questionID=_startid+3,add_answerID=ThisItem.ID)).answer
                                )
                                */
                            Width: =Parent.Width-20
                            X: =10
                            Y: =50
                            ZIndex: =3

            ContainerJTBD As groupContainer.manualLayoutContainer:
                Height: =Parent.Height-10
                Width: =Parent.Width/7.5
                X: |-
                    =ContainerCustomer.X-
                    ContainerCustomer.Width
                ZIndex: =3

                LabelBoxJTBD As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =4

                LabelTitleJTBD As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: =_lJTBD
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =5

                LabelDetailJTBD As label:
                    Height: =Parent.Height-LabelTitleCustomer.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lJTBDData
                        
                        /**
                        With({_startid:6},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        )
                        */
                    Width: =Parent.Width-20
                    X: =10
                    Y: =50
                    ZIndex: =6

            ContainerCustomer As groupContainer.manualLayoutContainer:
                Height: =Parent.Height-10
                Width: =Parent.Width/7.5
                X: =Parent.Width-ContainerCustomer.Width
                ZIndex: =4

                LabelBoxCustomer As label:
                    BorderColor: =RGBA(0, 13, 75, 1)
                    BorderThickness: =2
                    Height: =Parent.Height-10
                    Text: =
                    Width: =Parent.Width-10
                    X: =5
                    Y: =5
                    ZIndex: =7

                LabelTitleCustomer As label:
                    FontWeight: =Semibold
                    Height: =44
                    Size: =16
                    Text: =_lCustomer
                    Width: =Parent.Width-20
                    X: =10
                    ZIndex: =8

                LabelDetailCustomer As label:
                    Height: =Parent.Height-LabelTitleCustomer.Height-20
                    Overflow: =Overflow.Scroll
                    Size: =11
                    Text: |-
                        =_lCustomerData
                        
                        /**
                        With({_startid:3},
                        _lIcon&LookUp(questionList,ID=_startid).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+1).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+1).answer
                        &_lNewLine&_lNewLine&
                        _lIcon&LookUp(questionList,ID=_startid+2).Title
                        &_lNewLine&
                        LookUp(_gAnswerList,questionID=_startid+2).answer
                        )
                        */
                    Width: =Parent.Width-20
                    X: =10
                    Y: =50
                    ZIndex: =10

            IconArrow_1 As icon.ChevronLeft:
                Color: =RGBA(0, 13, 75, 1)
                DisplayMode: =DisplayMode.View
                Height: =Parent.Height-10
                Icon: =Icon.ChevronLeft
                Width: =30
                X: =184
                Y: =10
                ZIndex: =5

